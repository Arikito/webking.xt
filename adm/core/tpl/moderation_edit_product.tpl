<h1><?=$header?></h1><div id="edit_modprodae" class="grid">	<div class="row">		<form class="col-md-6" action="" id="editbox" method="post">			<input type="hidden" name="id" value="<?=$_POST['id'];?>">			<label for="product_name" class="name">Название:</label>			<input type="text" name="name" id="product_name" class="input-l" maxlength="255" autocomplete="off" required value="<?=isset($_POST['name'])? htmlspecialchars($_POST['name']):null;?>">			<label for="descr" class="descr">Описание:</label>			<textarea name="descr" id="descr" class="input-l" rows="8" required><?=isset($_POST['descr'])? str_replace('<br>', '', $_POST['descr']):null;?></textarea>			<label>Изображения товара:</label>			<div class="row" id="preview1">				<div class="col-md-2"><img class="pic_block" id="i1" src="<?=(isset($_POST['img_1'])&&$_POST['img_1']!='')?htmlspecialchars(str_replace("/efiles/", "/efiles/_thumb/", $_POST['img_1'])):"/efiles/_thumb/image/nofoto.jpg"?>"></div>				<div class="col-md-10"><input type="text" id="img_1" name="img_1" class="input-l" value="<?=isset($_POST['img_1'])?htmlspecialchars($_POST['img_1']):null?>"></div>			</div>			<div class="row" id="preview2">				<div class="col-md-2"><img class="pic_block" id="i2" src="<?=(isset($_POST['img_2'])&&$_POST['img_2']!='')?htmlspecialchars(str_replace("/efiles/", "/efiles/_thumb/", $_POST['img_2'])):"/efiles/_thumb/image/nofoto.jpg"?>"></div>				<div class="col-md-10"><input type="text" id="img_2" name="img_2" class="input-l" value="<?=isset($_POST['img_2'])?htmlspecialchars($_POST['img_2']):null?>"></div>			</div>			<div class="row" id="preview3">				<div class="col-md-2"><img class="pic_block" id="i3" src="<?=(isset($_POST['img_3'])&&$_POST['img_3']!='')?htmlspecialchars(str_replace("/efiles/", "/efiles/_thumb/", $_POST['img_3'])):"/efiles/_thumb/image/nofoto.jpg"?>"></div>				<div class="col-md-10"><input type="text" id="img_3" name="img_3" class="input-l" value="<?=isset($_POST['img_3'])?htmlspecialchars($_POST['img_3']):null?>"></div>			</div>			<label for="id_unit" class="units">Еденицы измерения:</label>			<select class="input-l" name="id_unit" id="id_unit">				<?foreach($units as $value){?>					<option value="<?=$value['id']?>" <?=isset($_POST['id_unit'])&&$_POST['id_unit']==$value['id']?'selected="true"':null?>><?=$value['unit_xt']?></option>				<?}?>			</select>			<label for="min_mopt_qty">Минимально отпускаемое количество товара:</label>			<input class="input-l wa" type="text" id="min_mopt_qty" name="min_mopt_qty" required value="<?=isset($_POST['min_mopt_qty'])? $_POST['min_mopt_qty']:null;?>"> <span></span>			<label for="qty_control" class="qty_control">Кратность минимального количества:				<input type="checkbox" name="qty_control" id="qty_control" class="input-l" value="1" <?=(isset($_POST['qty_control']) && $_POST['qty_control'] == 1)?'checked="true"':null;?>>			</label>			<label for="inbox_qty">Оптовое количество товара:</label>			<input type="text" id="inbox_qty" class="input-l wa" name="inbox_qty" required value="<?=isset($_POST['inbox_qty'])? $_POST['inbox_qty']:null;?>"> <span></span>			<label for="price_mopt">Цена за единицу товара при минимальном количестве:</label>			<input type="text" id="price_mopt" class="input-l wa" name="price_mopt" required value="<?=isset($_POST['price_mopt'])? $_POST['price_mopt']:null;?>"><span> грн</span>			<label for="price_opt">Оптовая цена:</label>			<input type="text" id="price_opt" class="input-l wa" name="price_opt" required value="<?=isset($_POST['price_opt'])? $_POST['price_opt']:null;?>"><span> грн</span>			<label for="weight" class="weight">Вес:</label>			<input type="text" name="weight" id="weight" class="input-l wa" value="<?=isset($_POST['weight'])? $_POST['weight']:null;?>"><span> кг</span>			<label for="volume" class="volume">Объем:</label>			<input type="text" name="volume" id="volume" class="input-l wa" value="<?=isset($_POST['volume'])? $_POST['volume']:null;?>"><span> м&#179;</span>			<label for="product_limit" class="product_limit">Актуальный остаток:</label>			<input type="text" name="product_limit" id="product_limit" class="input-l wa" required value="<?=isset($_POST['product_limit'])? $_POST['product_limit']:null;?>"> <span></span>			<div class="clear"></div>			<button type="submit" id="submit" class="btn-l-default save-btn" name="smb">Сохранить</button>		</form>	</div></div><script>	<?if(isset($_POST['moderation_status']) == true && $_POST['moderation_status'] == 2){?>		$('#editbox input,#editbox select, #editbox textarea').prop('disabled', true);	<?}?>	showUnits();	$('[id^="img_"]').on('change', function(){		validatePhoto();	});	$('#product_name').blur(function(){		validateName();	});	$('#id_unit').change(function(){		showUnits();	});	$('#min_mopt_qty, #inbox_qty').blur(function(){		validateMinMoptQty();		validateInboxQty();	});	$('#price_mopt, #price_opt').blur(function(){		validateOptPrice();	});	$('#product_limit').blur(function(){		validateProductLimit();	});	function validateName(){		if($('#product_name').val() == ''){			registerError('product_name','+','Имя не указано');		}else{			registerError('product_name','-');		}	}	function validateUnits(){		if($('#units').val().match('[0-9]')){			registerError('units','+','Это значение не может содержать числа');		}else if($('#units').val() == ''){			registerError('units','+','Не указаны еденицы измерения');		}else{			registerError('units','-');		}	}	function validateMinMoptQty(){		if(parseInt($('#min_mopt_qty').val()) <= 0 || $('#min_mopt_qty').val() == ''){			registerError('min_mopt_qty','+','Не указано минимальное количество');		}else{			registerError('min_mopt_qty','-');		}		if(parseInt($('#min_mopt_qty').val()) == 1){			$('#qty_control').prop('disabled', true).prop('checked', false);		}else{			$('#qty_control').prop('disabled', false);		}	}	function validateInboxQty(){		if(parseInt($('#inbox_qty').val()) <= 0 || $('#inbox_qty').val() == ''){			registerError('inbox_qty','+','Не указано количество в ящике');		}else if(parseInt($('#inbox_qty').val()) <= parseInt($('#min_mopt_qty').val())){			registerError('inbox_qty','+','Количество в ящике должно быть больше минимального количества');		}else{			registerError('inbox_qty','-');		}	}	function validateMoptPrice(){		if(parseFloat($('#price_mopt').val()) <= 0 || $('#price_mopt').val() == ''){			registerError('price_mopt','+','Не указана розничная цена');		}else{			registerError('price_mopt','-');		}		console.log(errors);	}	function validateOptPrice(){		if(parseFloat($('#price_opt').val()) <= 0 || $('#price_opt').val() == ''){			registerError('price_opt','+','Не указана оптовая цена');		}else if(parseFloat($('#price_opt').val()) > parseFloat($('#price_mopt').val()) && parseFloat($('#price_mopt').val()) > 0){			registerError('price_opt','+','Оптовая цена не может превышать розничную');		}else{			registerError('price_opt','-');		}	}	function validateProductLimit(){		if(parseInt($('#product_limit').val()) <= 0 || $('#product_limit').val() == ''){			registerError('product_limit','+','Товар должен быть в наличии');		}else{			registerError('product_limit','-');		}	}	function showUnits(){		$('#min_mopt_qty + span, #inbox_qty + span, #product_limit + span').hide().html($('#id_unit option:selected').text()).fadeIn();	}	function registerError(key, direction, content){		if(direction == "+"){			errors[key] = content;			$('#'+key).css('color', '#f33').closest('.row').find('p.error').remove();			$('#'+key).closest('.row').append('<p class="error" style="display: block; width: 60%;font-weight: normal; float: right; color: #f00;clear: both;">'+content+'</p>');		}else if(direction == "-"){			delete errors[key];			$('#'+key).css('color', '#000').closest('.row').find('p.error').remove();		}		if(count(errors) > 0){			$('#submit').prop('disabled', true);		}else{			$('#submit').prop('disabled', false);		}	}	$('#submit').on('click', function(){		$('.photo_upload_area').each(function(){			if($(this).find('#photo_preview').html() == '' && $(this).find('[id^="img_"]').val().length > 0){				deletePhoto($(this).prop('class').replace(/\D+/g,""), $(this).find('[id^="img_"]').val());				$(this).find('[id^="img_"]').val('');			}		});		if(validateForm() == true){			$(this).closest('form').submit();		}else{			return false;		}	});	function validateForm(){		validateName();		validatePhoto();		validateUnits();		validateMinMoptQty();		validateInboxQty();		validateMoptPrice();		validateOptPrice();		validateProductLimit();		if($('#submit').prop('disabled') == true){			return false;		}else{			return true;		}	}</script>
<h1><?=$h1?></h1><br><?if (isset($errm) && isset($msg)){?>	<div class="notification error">		<span class="strong">Ошибка!</span><?=$msg?>	</div>	<br><?}elseif(isset($msg)){?>	<div class="notification success">		<span class="strong">Сделано!</span><?=$msg?>	</div>	<br><?}?>	<form id="catform" name="catform" action="<?=$GLOBALS['URL_request']?>" method="post">	<div class="mb5">		<a class="dashed" href="javascript:ExpandAll();">Развернуть все</a>		<a class="dashed" href="javascript:CollapseAll();">Свернуть все</a>	</div>	<style>		tr:hover{background-color:#fffaf0;}		.mr6{margin-right:6px;}		.legend{margin-top:40px; float:right;}		.legend p IMG{display:inline;vertical-align:middle; margin-left: 20px;}	</style>	<script type="text/javascript">		var id_category_arr = Array();		var category_level_arr = Array();		var ii=0;	</script>	<table width="100%" border="0" cellspacing="0" cellpadding="0" class="list paper_shadow_1">		<col width="1%">		<col width="6%">		<col width="*">		<col width="50px">		<col width="1%">		<thead>			<tr>				<td class="left">Арт.</td>				<td class="left">Prom ID</td>				<td class="left">Название раздела</td>				<td class="center">&uarr; &darr;</td>				<td class="left" style="padding-left:10px;">Управление</td>			</tr>		</thead>		<tbody>			<?$ii = 0;			$prev_level = 0;			$tigra = false;			foreach($list as $i){				if($i['category_level']){?>					<tr id="block_<?=$i['pid']?>_<?=$i['id_category']?>" style="border-bottom: 1px solid #ddd">						<td class="left"><?=$i['art']?></td>						<td class="left"><?=$i['prom_id']?></td>						<td>							<span style="margin-left:<?=$i['category_level']*18-18?>px;">								<?if(!$i['childrens']){?>									<span style="margin-left:19px;"></span>								<?}?>								<a <?if(!$i['childrens']){?>style="display:none"<?}?> href="javascript:block_invert(<?=$i['id_category']?>);">									<img style="margin-bottom:-3px;" id="btn_<?=$i['id_category']?>" src="<?=$GLOBALS['URL_base']?>/adm/images/plus.gif" border=0/>								</a>								<?if($i['category_level']>0){?>									<script type="text/javascript">										id_category_arr[ii] = <?=$i['id_category']?>;										category_level_arr[ii++] = <?=$i['category_level']?>;									</script>								<?}?>								<?=!$i['visible']?'<span class="invisible">(скрытая) </span>':null?>								<a href="<?=$GLOBALS['URL_base'].'adm/products/'.$i['id_category']?>"><?=$i['name']?></a>							</span>						</td>						<td>							<nobr>								<span style="margin-left:5px;">									<?if($i['category_level']){?>										<?if($i['prev']){?>											<a style="text-decoration:none;" href="/adm/cat/<?=$i['id_category']?>/<?=$i['prev']?>/before">												<img src="/adm/images/up.png" width="14" height="14"/>											</a>										<?}?>										<?if($i['next']){?>											<a style="text-decoration:none;" href="/adm/cat/<?=$i['id_category']?>/<?=$i['next']?>/after">												<img src="/adm/images/down.png" width="14" height="14"/>											</a>										<?}?>									<?}else{?>									<?} $prev_level=$i['category_level'];?>								</span>							</nobr>						</td>						<td class="right">							<nobr>								<a class="small mr6" title="Добавить товар" href="/adm/productadd/<?=$i['id_category']?>">									<img alt="Добавить товар" src="/adm/images/add.png" width="16" height="16"/>								</a>								<a class="small mr6" title="Редактировать категорию" href="/adm/catedit/<?=$i['id_category']?>">									<img alt="Редактировать" src="/adm/images/edit.png" width="16" height="16"/>								</a>								<a class="small mr6" title="Добавить подкатегорию" href="/adm/catadd/<?=$i['id_category']?>">									<img alt="Добавить подкатегорию" src="/adm/images/addsub.png" width="16" height="16"/>								</a>								<a class="small mr6" title="Посмотреть категорию на сайте" href="/products/<?=$i['id_category'].'/'.$i['translit']?>/">									<img alt="Посмотреть на сайте" src="/adm/images/globe.png" width="16" height="16"/>								</a>								<!-- <a class="small" title="Удалить" href="<?=$GLOBALS['URL_base'].'adm/catdel/'.$i['id_category']?>" onclick="return confirm('Точно удалить?');">									<img alt="Удалить" src="/adm/images/delete.png" width="16" height="16"/>								</a> -->							</nobr>						</td>					</tr>				<?}			}?>		</tbody>	</table></form><div class="legend">	<p>		<img src="/adm/images/add.png" width="16" height="16"/> — добавить товар в категорию		<img src="/adm/images/edit.png" width="16" height="16"/> — редактировать		<img src="/adm/images/addsub.png" width="16" height="16"/> — добавить подкатегорию		<img src="/adm/images/globe.png" width="16" height="16"/> — посмотреть на сайте		<img src="/adm/images/delete.png" width="16" height="16"/> — удалить	</p></div><div id="test"></div>	<script type="text/javascript">		var expand_arr = Array();		<?if(isset($_COOKIE['expand_arr'])){			echo "expand_arr = [{$_COOKIE['expand_arr']}];";		}?>		function block_invert(id_category){			var re = new RegExp(".*plus.*", "i");			if (re.test(document.getElementById('btn_' + id_category).src)) {				block_expand(id_category);				expand_arr.push(id_category);				Save_expand_arr();				document.getElementById('btn_' + id_category).src = "<?=$GLOBALS['URL_base']?>adm/images/minus.gif";			}else{				block_collapse(id_category);				document.getElementById('btn_' + id_category).src = "<?=$GLOBALS['URL_base']?>adm/images/plus.gif";			}		}		function block_expand(pid){			trarr = document.getElementsByTagName('tr');			t = "block_"+pid+"_(\\d+)";			var re = new RegExp(t,"i");			for (var j = 0; j < trarr.length; j++) {				if (re.test(trarr[j].id)){					trarr[j].style.display = '';					document.getElementById('btn_' + pid).src = "<?=$GLOBALS['URL_base']?>adm/images/minus.gif";					//block_expand(RegExp.$1);				}			}		}		function block_collapse(pid){			trarr = document.getElementsByTagName('tr');			del_from_arr(pid);			Save_expand_arr();			t = "block_"+pid+"_(\\d+)";			var re = new RegExp(t,"i");			for (var j = 0; j < trarr.length; j++) {				if (re.test(trarr[j].id)){					trarr[j].style.display = 'none';					document.getElementById('btn_' + pid).src = "<?=$GLOBALS['URL_base']?>adm/images/plus.gif";					block_collapse(RegExp.$1);				}			}		}		function ExpandAll(){			trarr = document.getElementsByTagName('tr');			for (var i = 0; i < id_category_arr.length; i++) {				id_category = id_category_arr[i];				for(var j=0; j < trarr.length; j++){					t = "block_\\d+_"+id_category;					var re = new RegExp(t,"i");					if (re.test(trarr[j].id)){						trarr[j].style.display = '';						document.getElementById('btn_' + id_category).src = "<?=$GLOBALS['URL_base']?>adm/images/minus.gif";					}				}			}		}		function CollapseAll(start){			trarr = document.getElementsByTagName('tr');			for (var i = 0; i < id_category_arr.length; i++) {				id_category = id_category_arr[i];				if (!start) {					del_from_arr(id_category);					Save_expand_arr();				}				for(var j=0; j < trarr.length; j++){					t = "block_\\d+_"+id_category+"$";					var re = new RegExp(t,"i");					if (re.test(trarr[j].id) && category_level_arr[i]>1){						trarr[j].style.display = 'none';						document.getElementById('btn_' + id_category).src = "<?=$GLOBALS['URL_base']?>adm/images/plus.gif";					}else if(re.test(trarr[j].id) && category_level_arr[i]==1){						document.getElementById('btn_' + id_category).src = "<?=$GLOBALS['URL_base']?>adm/images/plus.gif";					}				}			}		}		function del_from_arr(id_category){			tmp_arr = Array();			for(ii=0; ii<expand_arr.length;ii++){				if(expand_arr[ii]!=id_category)				tmp_arr.push(expand_arr[ii]);			}			expand_arr = tmp_arr;		}		function Save_expand_arr(){			/*document.getElementById('test').innerHTML = expand_arr.join(',');*/			setCookie("expand_arr", expand_arr.join(','));		}		CollapseAll(true);		<? if(isset($_COOKIE['expand_arr'])){			$expand_arr = explode(',', $_COOKIE['expand_arr']);			foreach ($expand_arr as $i){				echo "block_expand(".$i.");\n";			}			echo "Save_expand_arr();";		}?>		function artSearch(art){			$.ajax({				url: URL_base+'ajaxproducts',				type: "POST",				cache: false,				dataType : "json",				data: {						"art":art				},				statusCode: {					404: function(){						alert("page not found");					}				}			});		}	</script>
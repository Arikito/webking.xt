window.onbeforeunload=function(e){},$(window).on("load",function(){$("html, body").trigger("scroll")}),$(function(){GetLocation(),1==$(window.location.hash).length&&"modal"==$(window.location.hash).data("type")&&openObject(window.location.hash.replace("#","")),setTimeout(function(){"agree"!=$.cookie("useCookie")?($(".cookie_msg_js").css("top","calc(100% - "+$(".cookie_msg_js").outerHeight()+"px)"),$("body").on("click",".cookie_msg_js .close",function(e){e.preventDefault(),$(".cookie_msg_js").css("top","100%"),$.cookie("useCookie","agree",{expires:365}),setTimeout(function(){$(".cookie_wrap").remove(),$(".err_msg_as_title").css("opacity","1")},3e3)})):$(".err_msg_as_title").css("opacity","1")},2e3),$(".changeView_js").on("click",function(){var e=$(this).data("view");$(".productsListView i").removeClass("activeView"),$(this).addClass("activeView"),"list"==e?$(".cart_info .price_nav").removeClass("hidden"):$(".cart_info .price_nav").addClass("hidden"),ChangeView(e),resizeAsideScroll("click")}),$(".show_more_js").on("click",function(e){e.preventDefault();var a=$(this).closest(".products_page"),t=current_id_category,s=parseInt(a.find(".paginator li.active").first().text()),i=parseInt(a.find(".paginator li.active").last().text())+1,n=a.find(".card").get().length,o=30*(s-1),d=$(this).data("cnt");$(".show_more").append('<span class="load_more"></span>');var r={action:"getmoreproducts_desctop",id_category:t,shown_products:n,skipped_products:o};addLoadAnimation(".show_more_js"),ajax("products","getmoreproducts",r,"html").done(function(e){removeLoadAnimation(".show_more_js");$.cookie("product_view");var t=parseInt(d-30-parseInt(o+n));a.find(".products").append(e),$("img.lazy").lazyload({effect:"fadeIn"}),a.find(".paginator li.page"+i).length<1?parseInt(d-parseInt(o+n)+30)>30?a.find(".paginator li.next_pages").addClass("active").find("a").attr("href","#"):a.find(".paginator li.last_page").addClass("active").find("a").attr("href","#"):a.find(".paginator li.page"+i).addClass("active").find("a").attr("href","#"),t<0&&$("#show_more_products").hide(),$(".load_more").remove(),resizeAsideScroll("show_more")})}),$("body").on("change",".qty_js",function(){AddNoteArea($(this));var e=$(this).closest(".product_buy").attr("data-idproduct"),a=$(this).val(),t=$(this).closest(".product_section").find(".note textarea").val();SendToAjax(e,a,!1,!1,t)}),$("body").on("click",".buy_btn_js",function(){AddNoteArea($(this));var e=$(this).closest(".product_buy").attr("data-idproduct"),a=$(this).closest(".product_buy").find(".qty_js").val(),t=$(this).closest(".product_section").find(".note textarea").val();SendToAjax(e,a,!1,!1,t)}),$("body").on("click",".btn_qty_js",function(){AddNoteArea($(this))}),$(".note_field").blur(function(){""!==$(".note_field").val()&&$(this).closest(".card").find(".note").removeClass("activeNoteArea");var e=$(this).data("id"),a=$(this).val();ajax("cart","updateCartQty",{id_product:e,note:a})}),$("body").on("click",".remove_favor_js",function(e){e.preventDefault();var a=$(this).closest(".favorite_js").data("idproduct"),t=$(this);$("#confirmDelItem").data("delIdItem",a).data("list","favor"),t.addClass("clicked_js").closest(".tableRow").addClass("flag_js")}),$("body").on("click",".remove_waitinglist_js",function(e){e.preventDefault();var a=$(this).closest(".waiting_list_js").data("idproduct"),t=$(this);$("#confirmDelItem").data("delIdItem",a).data("list","waiting"),t.addClass("clicked_js").closest(".tableRow").addClass("flag_js")}),$("#confirmDelItem").on("click",".deleteBtn_js",function(){var e=$("#confirmDelItem").data("delIdItem"),a=$(".clicked_js");closeObject("confirmDelItem"),"favor"==$("#confirmDelItem").data("list")?(addLoadAnimation(".flag_js"),ajax("product","del_favorite",{id_product:e}).done(function(e){if(e.fav_count>0){a.closest(".favorite_js").remove(),$(".userChoiceFav").text("("+e.fav_count+")");var e={message:"Товар удален из списка избранных товаров"};document.querySelector("#snackbar").MaterialSnackbar.showSnackbar(e)}else $("#favorites").html("<h5>У Вас нет избранных товаров</h5>"),$(".userChoiceFav").text("(0)")})):"waiting"==$("#confirmDelItem").data("list")&&(addLoadAnimation(".flag_js"),ajax("product","del_from_waitinglist",{id_product:e}).done(function(e){if(e.fav_count>0){a.closest(".waiting_list_js").remove(),$(".userChoiceWait").text("("+e.fav_count+")");var e={message:"Товар удален из листа ожидания"};document.querySelector("#snackbar").MaterialSnackbar.showSnackbar(e)}else $("#waiting_list").html("<h5>Лист ожидания пуст</h5>"),$(".userChoiceWait").text("(0)")})),a.removeClass("clicked_js"),$(".flag_js").removeClass("flag_js")}),$("#confirmDelItem").on("click",".cancelBtn_js",function(){$("#confirmDelItem").removeData("delIdItem"),$(".clicked_js").removeClass("clicked_js"),$(".flag_js").removeClass("flag_js"),closeObject("confirmDelItem")}),$("#cart").on("click",".this_my_number_js",function(){var e=$("#cart #user_number").val();$("#confirmMyPhone .new_phone").val(e)}),$("#confirmMyPhone").on("click",".send_confirm_sms_js",function(){var e=$("#confirmMyPhone .new_phone").val().replace(/[^\d]+/g,"");$("#confirmMyPhone .new_phone").val(e),addLoadAnimation("#confirmMyPhone"),ajax("auth","recoverPhone",{phone:e}).done(function(){removeLoadAnimation("#confirmMyPhone"),$("#confirmMyPhone .ask_send_code_js").addClass("hidden"),$("#confirmMyPhone .ver_info_js").removeClass("hidden"),Position($('[data-type="modal"].opened')),$("#verification_code").focus()})}),$("#confirmMyPhone").on("click",".confirm_js",function(){var e=$("#verification_code").val(),a=$("#confirmMyPhone .new_phone").val();""===e?$("#verification_code").closest("div").addClass("is-invalid"):(addLoadAnimation("#confirmMyPhone"),ajax("auth","checkСodePhone",{phone:a,code:e}).done(function(){removeLoadAnimation("#confirmMyPhone"),$("#confirmMyPhone .ver_info_js").addClass("hidden"),$("#confirmMyPhone .ver_info_success_js").removeClass("hidden"),Position($('[data-type="modal"].opened'))}))}),$("#confirmMyPhone .continue_make_order_js").on("click",function(){closeObject("confirmMyPhone"),openObject("cart"),GetCartAjax()});$("#seoTextBlock").text();0===$('ul.second_nav.allSections > li.active > ul[data-lvl="2"] > li.active:has(ul)').length||$('ul.second_nav.allSections ul[data-lvl="3"] > li').hasClass("active")?$('.main_nav li[data-nav="filter"]').removeClass("hidden"):$('.main_nav li[data-nav="filter"]').addClass("hidden"),0===$("ul.second_nav.allSections li.active").find("li.active").length&&$('.main_nav li[data-nav="filter"]').addClass("hidden"),$("#segmentNavOrg, #segmentNavStore, #allCategotyCont").find("li.active")&&0===$("ul.second_nav li.active").find("li.active").length&&$('.main_nav li[data-nav="filter"]').addClass("hidden"),$(".main_nav > li").click(function(){$(".main_nav > li").hasClass("active")&&!$("ul.second_nav li").hasClass("active")&&$('.main_nav li[data-nav="filter"]').addClass("hidden")}),$('.second_nav > li[onclick^="segmentOpen"]').click(function(){$('.main_nav li[data-nav="filter"]').addClass("hidden")}),$("body").on("click",'a[href="#"]',function(e){e.preventDefault()});var e=$(window).width(),a=$(window).height(),t=($("section .center").height(),$("header").outerHeight());$("img.lazy").lazyload({effect:"fadeIn"}),$(".prod_structure span.list").on("click",function(){ChangeView("list")}),$(".prod_structure span.module").on("click",function(){ChangeView("module")});var s=.9;e>712&&(s=.8),$("#cart .order_wrapp").css("max-height",(a-t)*s),$(".mob_s_btn").on("click",function(){$("#search").focus()}),$("#search").on("keyup",function(){""!==$(this).val()?$(".search_btn").hasClass("is-disabled")||$(".search_btn").addClass("is-disabled"):$(".search_btn").hasClass("is-disabled")&&$(".search_btn").removeClass("is-disabled")}),$("#category-lower-right").on("click",function(e){e.preventDefault()}),$(".imit_select").on("click",".mdl-menu__item",function(){var e=$(this).text();$(this).data("value");$(this).closest(".imit_select").find(".mdl-menu__item").removeClass("active"),$(this).closest(".imit_select").find(".select_field").text(e),$(this).closest(".mdl-menu__container").removeClass("is-visible"),$(this).addClass("active")}),$(".region.imit_select").on("click",".mdl-menu__item",function(){GetCities($(".region.imit_select").find(".select_field").text()),$(".city.imit_select").find(".select_field").text("Выбрать")}),$(".sort.imit_select .mdl-menu__item").on("click",function(){var e=JSON.parse($.cookie("sorting"));if(void 0!==e.current_controller){e.current_controller.value=$(this).data("value");var a=JSON.stringify(e);$.cookie("sorting",a,{expires:2,path:"/"}),location.reload()}}),$(".menu").on("click",function(){var e=$(this).text();$("header").outerHeight();"menu"==e?$(this).html("close"):$(this).html("menu")}),$(".search_close").on("click",function(){closeObject()});var i=$("header"),n=!!$("body").hasClass("advantages_hide"),o=$(".advantages").outerHeight(),d=($(window).height(),$(window).width());$(".main").outerHeight(),$(".main_nav").outerHeight(!0);$(".breadcrumbs .btn_js").on("click",function(){!0===IsMobile&&d>=728&&!1===$("body").hasClass("no-sidebar")&&$(this).removeClass("btn_js")}),$(".logo").on("click",function(e){$("body").hasClass("c_main")&&!0===n&&(e.preventDefault(),$(".advantages").animate({height:o},300),$("html, body").animate({scrollTop:0},300),$("body").removeClass("advantages_hide"),i.removeClass("fixed_panel").addClass("default"),setTimeout(function(){n=!1},305),!0===IsMobile&&$("aside").css({position:"absolute",bottom:"auto",top:"auto"}))}),$("mdl-menu__container").hover(function(){$(this).addClass("is-visible")},function(){$(this).removeClass("is-visible")}),$(".second_nav li.active > ul").show(),$(".catalog .label").on("click",function(){var e=0;if($(this).closest(".catalog").toggleClass("expanded"),$(this).closest(".catalog").hasClass("expanded")){var a=$(".navbar_js").find('[data-lvl="1"] > .link_wrap');e=a.length*a.first().outerHeight()}$(".navbar_js").height(e)}),$(".catalog").on("click",".main_nav li",function(){"filter"==$(this).data("nav")?"filter_list"==$(this).find("i").text()?($(this).find("i").text("highlight_off"),$(this).find("span.title").text("Скрыть"),$(".second_nav, .news ").slideUp(),$(".included_filters").hide(),$(".filters").fadeIn(),$(this).addClass("active")):($(this).find("i").text("filter_list"),$(this).find("span.title").text("Фильтры"),$(".filters").fadeOut(),$(".second_nav, .news").slideDown(),$(".included_filters").show(),$(this).removeClass("active"),$(this).removeClass("hidden")):($(".catalog .main_nav li").removeClass("active"),$(this).addClass("active"))}),$(".menus").on("click",function(){var e=$(this).closest("li").find("ul");e.hasClass("active")?e.removeClass("active").stop(!0,!0).slideUp():e.addClass("active").stop(!0,!0).slideDown()});var r=getScrollWindow();changeToTop(r),$(window).scroll(function(){r=getScrollWindow(),changeToTop(r)}),$("#toTop").click(function(){$("html, body").animate({scrollTop:0},1e3,"easeInOutCubic")});var c=$(".price"),l=$(".price_nav");if(c.length>0){var _=Math.round(c.offset().left+c.width()/2-l.width()/2);l.offset({left:_})}$(".product_main_img").css("height",$(".product_main_img").outerWidth()),$("#owl-product_mini_img_js").owlCarousel({items:6,itemsCustom:[[320,1],[727,2],[950,3],[1250,4],[1600,5]],navigation:!0,dots:!1,navigationText:['<svg class="arrow_left"><use xlink:href="images/slider_arrows.svg#arrow_left_tidy"></use></svg>','<svg class="arrow_right"><use xlink:href="images/slider_arrows.svg#arrow_right_tidy"></use></svg>']}),$("#owl-popular, #owl-other, #owl-last-viewed, #owl-accompanying, #owl-new-products").owlCarousel({autoPlay:!1,dots:!1,stopOnHover:!0,slideSpeed:300,paginationSpeed:400,itemsScaleUp:!0,responsive:{320:{items:1},727:{items:3},950:{items:5},1250:{items:6},1600:{items:8}},nav:!0,navText:['<svg class="arrow_left"><use xlink:href="images/slider_arrows.svg#arrow_left_tidy"></use></svg>','<svg class="arrow_right"><use xlink:href="images/slider_arrows.svg#arrow_right_tidy"></use></svg>']}),$("#owl-top").owlCarousel({autoPlay:!1,dots:!1,stopOnHover:!0,slideSpeed:300,items:4,paginationSpeed:400,itemsScaleUp:!0,nav:!0,navText:['<svg class="arrow_left"><use xlink:href="images/slider_arrows.svg#arrow_left_tidy"></use></svg>','<svg class="arrow_right"><use xlink:href="images/slider_arrows.svg#arrow_right_tidy"></use></svg>']}),$(".set_rating").on("change",function(){var e=$(this).val();changestars(e)}),$(".star").hover(function(){var e=$(this).closest("label").find("input").val();changestars(e),$(".feedback_stars").on("mouseleave",function(){(e=$(this).find("input:checked").val())||(e=0),changestars(e)})}),$(".star").on("click",function(e){var a=$(this).closest("label").find("input");a.is(":checked")&&(e.preventDefault(),a.removeAttr("checked"),changestars(0))}),$("input.mdl-checkbox__input").on("click",function(){}),$("body").on("click",".background_panel",function(){closeObject()}),$('[data-type="modal"]').each(function(e,a){$(this).append('<a href="#" class="close_modal btn_js" data-name="'+$(this).attr("id")+'"><i class="material-icons mdl-cell--hide-phone mdl-cell--hide-tablet">close</i><i class="material-icons mdl-cell--hide-desktop">cancel</i></a>')}),$(".product_main_img").on("click",function(){var a=$(this).find("img").attr("src"),t=$(this).find("img").attr("alt");$("#big_photo img").attr({src:a,alt:t}),$("#big_photo").css({"max-width":.9*e}),images=[],$("#owl-product_mini_img_js .owl-item").each(function(){$(this).find("img"),images.push($(this).find("img").attr("class"))});var s=0;$.each(images,function(e,a){"act_img"===a&&(s=e)});var i=$("#big_photos_carousel_js");i.owlCarousel(),i.trigger("to.owl.carousel",[s,500])}),$("#big_photo img").on("click",function(){closeObject()}),$("body").on("click",".btn_js",function(){var e=$(this).data("name");void 0!==e&&openObject(e)}),$(document).keyup(function(e){27==e.keyCode&&closeObject()}),$("body").on("click",".show_demand_chart_js, .chart_edit_js",function(){ModalDemandChart($(this).data("idcategory"))}),$("#demand_chart").on("click",".btn_js.save, .btn_js.update",function(){var e=$(this).closest("#demand_chart"),a=e.data("target"),t=0,s=e.find("#name_user").val(),i=e.find("textarea").val(),n=e.find('.one input[type="range"]'),o=e.find('.two input[type="range"]'),d={roz:{},opt:{}},r=e.find('input[type="hidden"][name="roz_id_chart"]').val(),c=e.find('input[type="hidden"][name="opt_id_chart"]').val();$(".select_go label").is(":checked")&&(t=1),n.each(function(e,a){d.roz[e]=$(a).val()}),o.each(function(e,a){d.opt[e]=$(a).val()}),$(this).hasClass("save")?ajax("product","SaveDemandChart",{values:d,id_category:a,name_user:s,text:i,opt:t}).done(function(e){0==$(".save.btn_js").data("isadmin")?($("#demand_chart_msg .modal_container").html('<div class="msg_wrap"><h3>Благодарим Вас!</h3><p>Данные успешно сохранены.</p><p>После проверки модератором, внесенные Вами изменения будут учтены в итоговом графике спроса данной категории.</p></div>'),componentHandler.upgradeDom(),closeObject("demand_chart"),openObject("demand_chart_msg")):!0===e&&(closeObject("demand_chart"),location.reload())}):ajax("product","UpdateDemandChart",{values:d,id_category:a,name_user:s,text:i,opt:t,id_charts:r+", "+c}).done(function(e){0==$(".update.btn_js").data("isadmin")?($("#demand_chart_msg .modal_container").html('<div class="msg_wrap"><h3>Благодарим Вас!</h3><p>Данные успешно сохранены.</p><p>После проверки модератором, внесенные Вами изменения будут учтены в итоговом графике спроса данной категории.</p></div>'),componentHandler.upgradeDom(),closeObject("demand_chart"),openObject("demand_chart_msg")):!0===e&&(closeObject("demand_chart"),location.reload())})}),$("body").on("click","#demand_chart_msg .close_modal",function(){location.reload()}),$("body").on("click",".avg_chart_det_btn_js",function(){$("#details_btn").hasClass("clicked")?($("#details_btn").removeClass("clicked"),$(".avg_chart_det_btn i").css("transform","rotate(0deg)"),$(".charts_container").css("border-color","transparent"),$(".charts_container .charts_title").addClass("hidden"),$(".charts_wrap").empty()):(addLoadAnimation("#details_btn"),ajax("product","ChartsByCategory",{id_category:$(this).data("idcategory")},"html").done(function(e){$(".avg_chart_det_btn i").css("transform","rotate(90deg)"),$(".charts_container .charts_title").removeClass("hidden"),$(".charts_container").css("border-color","#e0e0e0"),$("#details_btn").addClass("clicked"),removeLoadAnimation("#details_btn"),$(".charts_wrap").html(e),componentHandler.upgradeDom()}))}),$(".note textarea").on("blur",function(){}),$(".add_cart_state input:radio").on("click",function(){var e=!1;$(this.checked)&&(e=!0),$(this).prop("checked",e)}),$("#quiz").on("click",".to_step",function(e){function a(e){if(addLoadAnimation("#quiz"),e.target_step>e.current_step&&!0===e.validate)ajax("quiz","complete_step",e).done(function(a){if(console.log(a),!0===a.success){var t={reload:!1,step:a.target_step?a.target_step:e.target_step};a.target_id_order&&(t.target_id_order=a.target_id_order),a.id_user&&(t.id_user=a.id_user),GetQuizAjax(t)}});else{var a={reload:!1,step:e.target_step};response.target_id_order&&(a.target_id_order=response.target_id_order),response.id_user&&(a.id_user=response.id_user),GetQuizAjax(a)}}e.preventDefault();var t=0,s={validate:!1,current_step:$(this).closest('[class*="step_"]').data("step"),target_step:$(this).data("step"),id_user:$(this).closest('[class*="step_"]').data("id_user"),target_id_order:$(this).closest('[class*="step_"]').data("target_id_order")},i={summary:$("#quiz .summary_info"),current:$(".step_"+$(this).closest('[class*="step_"]').data("step")),target:$(".step_"+$(this).data("step"))};console.log(s),1==s.target_step?2==s.current_step&&a(s):2==s.target_step?1==s.current_step?($(this).hasClass("use_selected")?(s.id_address=i.current.find('[name="address"]').val(),null===s.id_address&&(t++,i.current.find(".mdl-selectfield.address").addClass("is-invalid"))):$(this).hasClass("create_new")?console.log("create clicked"):(s.last_name=i.current.find('[name="last_name"]').val(),s.first_name=i.current.find('[name="first_name"]').val(),s.middle_name=i.current.find('[name="middle_name"]').val(),0===s.last_name.length&&(t++,i.current.find('[name="last_name"]').addClass("is-invalid")),0===s.first_name.length&&(t++,i.current.find('[name="first_name"]').addClass("is-invalid")),0===s.middle_name.length&&(t++,i.current.find('[name="middle_name"]').addClass("is-invalid"))),0===t&&(s.validate=!0,a(s))):3==s.current_step&&a(s):3==s.target_step?2==s.current_step?(s.region=i.current.find("#region").val(),s.city=i.current.find("#city").val(),null!==s.region&&0!==s.region.length||(i.current.find(".region").addClass("is-invalid"),t++),null!==s.city&&0!==s.city.length||(i.current.find(".city").addClass("is-invalid"),t++),0===t&&(s.validate=!0,a(s))):4==s.current_step&&a(s):4==s.target_step?3==s.current_step&&(s.region=i.current.find("#region").val(),s.city=i.current.find("#city").val(),s.id_delivery=parseInt(i.current.find("#id_delivery").val()),s.id_delivery_service=parseInt(i.current.find("#id_delivery_service").val()),s.delivery_department=i.current.find("#delivery_department").val(),s.address=i.current.find("#address").val(),isNaN(s.id_delivery)?(i.current.find(".delivery").addClass("is-invalid"),t++):1==s.id_delivery?null!==s.delivery_department&&0!==s.delivery_department.length||(i.current.find(".delivery_department").addClass("is-invalid"),t++):2==s.id_delivery&&""===s.address&&(i.current.find(".address").addClass("is-invalid"),t++),isNaN(s.id_delivery_service)&&(i.current.find(".delivery_service").addClass("is-invalid"),t++),0===t&&(s.validate=!0,a(s))):5==s.target_step&&4==s.current_step&&(closeObject("quiz"),window.location.hash="",window.location.reload())}),$(".verification_btn").attr("disabled","disabled"),$("#verification").on("click",'[for="choise_current_pass"]',function(){$(".cur_passwd_container, .confirm_btn_js").removeClass("hidden"),$(".verification_meth, .for_verification_code_js, .confirm_code_js, .send_code_js, .ver_info_js").addClass("hidden"),$(".confirm_pass_js").removeClass("hidden"),$(".error_msg_js").text(""),componentHandler.upgradeDom()}),$("#verification").on("click",'[for="choise_verification_code"]',function(){$(".verification_meth, .send_code_js").removeClass("hidden"),$(".cur_passwd_container, .confirm_pass_js").addClass("hidden"),$(".confirm_code_js").addClass("hidden"),$(".error_msg_js").text(""),componentHandler.upgradeDom()}),$('[name="cur_passwd"]').change(function(e){""==$(this).val()?$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Чтобы продолжить введите Ваш текущий пароль"):$(this).val().length<4&&$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Введите корректный пароль")}),$('[name="verification_code"]').change(function(e){""==$(this).val()?$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Чтобы продолжить введите код подтверждения"):4!=$(this).val().length&&$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Введите корректный код подтверждения")}),$(".send_code_js").click(function(e){$(".for_verification_code_js").removeClass("hidden"),$(".send_code_js").addClass("hidden"),$(".confirm_code_js, .ver_info_js").removeClass("hidden");var a=$('[name="id_user"]').val(),t=$(".phone").val().replace(/[^\d]+/g,"");12==t.length&&(phone=t),data={id_user:a,phone:phone,method:"sms"},ajax("cabinet","AccessCode",data).done(function(e){$(".confirm_btn_js").removeAttr("disabled")})}),$(".confirm_pass_js").click(function(e){var a=$('[name="id_user"]').val(),t=$('[name="new_passwd"]').val(),s=$('[name="verification"]:checked').data("value"),i=$('[name="cur_passwd"]').val();data={id_user:a,new_passwd:t,curr_pass:i,method:s},$(".cur_passwd").hasClass("is-invalid")||ajax("cabinet","ChangePassword",data).done(function(e){e.success?$("#verification").html('<div class="auth_ok tac"><i class="material-icons">check_circle</i></div><p class="info_text" style="min-width: 300px; text-align: center;">Пароль успешно изменен!</p><a href="#" class="close_modal btn_js" data-name="verification"><i class="material-icons mdl-cell--hide-phone mdl-cell--hide-tablet">close</i><i class="material-icons mdl-cell--hide-desktop">cancel</i></a>'):$(".error_msg_js").text(e.msg)})}),$(".confirm_code_js").click(function(e){var a=$('[name="id_user"]').val(),t=$('[name="new_passwd"]').val(),s=$('[name="verification"]:checked').data("value"),i=$('[name="verification_code"]').val();data={id_user:a,code:i,new_passwd:t,method:s},$(".for_verification_code_js").hasClass("is-invalid")||ajax("cabinet","ChangePassword",data).done(function(e){e.success?$("#verification").html('<div class="auth_ok tac"><i class="material-icons">check_circle</i></div><p class="info_text" style="min-width: 300px; text-align: center;">Пароль успешно изменен!</p><a href="#" class="close_modal btn_js" data-name="verification"><i class="material-icons mdl-cell--hide-phone mdl-cell--hide-tablet">close</i><i class="material-icons mdl-cell--hide-desktop">cancel</i></a>'):$(".error_msg_js").text(e.msg)}).fail(function(e){alert("Ошибка!")})}),$(".phone").mask("+38 (099) ?999-99-99"),$('input[name="options"]').on("change",function(){$("#quiz .company_details").css("display","block")}),$("#quiz .delivery_service").on("click",'input[name="service"]',function(){$('.delivery_service input[name="service"]:checked')&&$('[data-value="2"]')&&(GetDeliveryMethods($(this).val(),$("#city_select .select_field").text()),Position($(this).closest('[data-type="modal"]')))}),$('.delivery_type [data-value="1"]').on("click",function(){$(".delivery_address").css("display","block"),$(".post_office").css("display","none")}),$('.delivery_type [data-value="2"]').on("click",function(){$('.delivery_service input[name="service"]:checked')&&($(".post_office").css("display","block"),$(".delivery_address").css("display","none"),GetDeliveryMethods($('.delivery_service input[name="service"]:checked').val(),$("#city_select .select_field").text()))}),$("#quiz .mdl-button").on("click",function(e){return e.preventDefault(),!1}),$("#access_recovery").on("click",'label[for="chosen_mail"]',function(){$("#access_recovery #recovery_email").closest("div").addClass("hidden"),$("#access_recovery .input_container").html('<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label>Email</label><input class="mdl-textfield__input input_validator_js" data-input-validate="email" name="value" id="recovery_email"><label class="mdl-textfield__label" for="recovery_email"></label><span class="mdl-textfield__error"></span></div>'),componentHandler.upgradeDom()}),$("#access_recovery").on("click",'label[for="chosen_sms"]',function(){$("#access_recovery #recovery_email").closest("div").addClass("hidden"),$("#access_recovery .input_container").html('<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label>Номер телефона</label><input class="mdl-textfield__input phone input_validator_js" data-input-validate="phone" name="value" type="text" id="recovery_phone"><label class="mdl-textfield__label" for="recovery_phone"></label><span class="mdl-textfield__error"></span></div>'),$(".phone").mask("+38 (099) ?999-99-99"),componentHandler.upgradeDom()}),$("#access_recovery").on("keyup",".input_container input",function(){$("#access_recovery .input_container input").closest("div").removeClass("is-invalid")}),$("#access_recovery").on("click","#continue",function(e){e.preventDefault();var a,t=$(this).closest('[data-type="modal"]'),s=t.find('[name="recovery_method"]:checked'),i=!1;if("sms"==s.data("value")){var n=$("#access_recovery .phone").val().replace(/[^\d]+/g,"");12==n.length&&(a=n,i=!0)}if("email"==s.data("value")){var o=t.find('[name="value"]').val();""!==o?/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i.test(o)?($("#access_recovery .input_container input").closest("div").removeClass("is-invalid"),a=o,i=!0):($("#access_recovery .input_container input").closest("div").addClass("is-invalid"),$(".mdl-textfield__error").text("Введите Email правильно")):($("#access_recovery .input_container input").closest("div").addClass("is-invalid"),$(".mdl-textfield__error").text("Введите Email"))}data={method:s.data("value"),value:a},!1===i?$("#access_recovery .input_container input").closest("div").addClass("is-invalid"):(addLoadAnimation("#access_recovery"),ajax("auth","accessRecovery",data).done(function(e){removeLoadAnimation("#access_recovery"),e.success?t.find(".password_recovery_container").html(e.content):t.find(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(e.msg),componentHandler.upgradeDom()}))}),$("#access_recovery").on("keyup","#passwd",function(e){e.preventDefault();var a=$(this).val(),t=$("#access_recovery #passwdconfirm").val();ValidatePass(a,$(this)),""!==t&&ValidatePassConfirm(a,t)}),$("#access_recovery").on("keyup","#passwdconfirm",function(){var e=$("#access_recovery #passwd").val(),a=$(this).val();ValidatePassConfirm(e,a)}),$("#access_recovery").on("click","#restore",function(e){e.preventDefault();var a=$(this).closest('[data-type="modal"]'),t=a.find('[type="hidden"]').val(),s=a.find('[name="code"]').val();data={id_user:t,code:s},addLoadAnimation("#access_recovery"),ajax("auth","checkСode",data).done(function(e){removeLoadAnimation("#access_recovery"),e.success?a.find(".password_recovery_container").html(e.content):a.find('[name="code"]').closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(e.msg),componentHandler.upgradeDom()})}),$("#access_recovery").on("click","#confirm_btn",function(e){e.preventDefault(),$("#access_recovery .mdl-textfield__error").empty();var a=$(this).closest('[data-type="modal"]'),t=a.find('[type="hidden"]').val(),s=a.find('input[name="new_passwd"]'),i=a.find('input[name="passwdconfirm"]').val();ValidatePass(s.val(),s),s.val().length>=4&&""!==i&&!ValidatePassConfirm(s.val(),i)&&(data={id_user:t,passwd:i},a.find(".mdl-textfield").hasClass("is-invalid")||(addLoadAnimation("#access_recovery"),ajax("auth","accessConfirm",data).done(function(e){console.log(e),removeLoadAnimation("#access_recovery"),e.success?($(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden"),ajax("auth","GetUserProfile",!1,"html").done(function(e){$("#user_profile").append('<img src="/images/noavatar.png"/>'),$(".user_profile_js").html(e),$(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden")}),a.find(".password_recovery_container").html(e.content)):value.closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(e.msg),componentHandler.upgradeDom()})))}),$("#regpasswd").keyup(function(e){e.preventDefault();var a=$(this).val(),t=$("#settings #passwdconfirm").val();ValidatePass(a,$(this)),""!==t&&ValidatePassConfirm(a,t)}),$("#passwdconfirm").keyup(function(){var e=$("#settings #regpasswd").val(),a=$(this).val();ValidatePassConfirm(e,a)}),$('#passwd, #regpasswd, [name="passwdconfirm"]').focusout(function(e){e.preventDefault(),$(this).closest(".mdl-textfield").find(".mdl-textfield__error").empty()}),$(".login_btn").on("click",function(e){openObject("auth"),$("#auth #sign_in").show().removeClass("hidden"),$("#auth #sign_up").hide().addClass("hidden"),e.preventDefault()}),$("#auth").on("click",".switch",function(e){e.preventDefault(),$(this).closest(".modal_container").fadeOut().addClass("hidden"),$("#"+$(this).data("name")).hide().removeClass("hidden").fadeIn(),Position($("#auth"))}),$("#auth").on("click",".sign_in",function(e){e.preventDefault(),addLoadAnimation("#sign_in");var a=$(this).closest("form"),t=a.find("input#email").val(),s=a.find("input#passwd").val();a.find(".error").fadeOut(),e.preventDefault();var i=t.replace(/\D/g,"");/^(38)?(\d{10})$/.test(i)&&(t=10===i.length?38+i:i),ajax("auth","sign_in",{email:t,passwd:s}).done(function(e){$(".userContainer");if(removeLoadAnimation("#sign_in"),1!=e.err){if(!0===n){var t=$(".products_page"),s=current_id_category,i=parseInt(t.find(".paginator li.active").first().text()),o=(parseInt(t.find(".paginator li.active").last().text()),30*(i-1));$(".show_more").append('<span class="load_more"></span>'),addLoadAnimation(".products");var d={action:"getmoreproducts_desctop",id_category:s,shown_products:0,skipped_products:o};"search"===current_controller||"product"===current_controller?location.reload():UpdateProductsList(t,d)}closeObject("auth"),3==e.member.gid&&($("#header_js .cart_item").addClass("hidden"),removeFromCart()),$(".login_btn").addClass("hidden"),e.member.avatar?$(".cabinet_btn").removeClass("hidden").find("img").attr("src",e.member.avatar):location.reload(),$(".cabinet_btn").find(".name").html(e.member.first_name?e.member.first_name:e.member.name),ajax("auth","GetUserProfile",!1,"html").done(function(e){$(".user_profile_js").html(e),$("#authorized").removeClass("hidden"),$(".userContainer").removeClass("hidden"),$('button[value="Неавторизован"]').addClass("hidden")}),void 0!==$("#auth").data("from")||current_controller}else a.find(".error").text(e.msg).fadeIn()})}),$('#sign_up [name="passwd"]').keyup(function(){var e=$(this).val(),a=$('#sign_up [name="passwdconfirm"]').val();ValidatePass(e,$(this)),""!==a&&ValidatePassConfirm(e,a)}),$('#sign_up [name="passwdconfirm"]').keyup(function(){var e=$('#sign_up [name="passwd"]').val(),a=$(this).val();ValidatePassConfirm(e,a)}),$("#sign_up .sign_up").click(function(e){e.preventDefault(),addLoadAnimation("#sign_up");var a=$(this).closest("form"),t=a.find('[name="name"]').val(),s=a.find('[name="phone"]').val(),i=a.find('[name="id_contragent"]').val(),n=a.find('[name="passwd"]').val(),o=a.find('[name="passwdconfirm"]').val(),d=s.replace(/\D/g,""),r={name:t,phone:s=10===d.length?38+d:d,id_contragent:i,passwd:n,passwdconfirm:o};ajax("auth","register",r).done(function(e){0===e.err?(ajax("auth","GetUserProfile",!1,"html").done(function(e){$(".user_profile_js").html(e),$(".login_btn").addClass("hidden"),$(".cabinet_btn").removeClass("hidden").find("img").attr("src","/images/noavatar.png")}),openObject("registerComplete")):$.each(e.errm,function(e,a){$('[name="'+e+'"]').closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").html(a)}),removeLoadAnimation("#sign_up")}).fail(function(e){console.log("fail"),console.log(e)})}),$(".error_js").click(function(e){e.preventDefault();var a={};$(this).closest("form").find(".mdl-textfield__input").each(function(e,t){a[$(t).attr("name")]=$(t).val()}),ajax("errors","error",a)}),$(".estimate_js").on("click",function(e){e.preventDefault();var a=$(this).closest(".modal_container"),t=a.find('input[name="phone"]').val();!0===!a.find(".mdl-textfield").hasClass("is-invalid")&&(addLoadAnimation("#estimateLoad"),ajax("product","AddEstimate",new FormData($(this).closest("form")[0]),"json",!0).done(function(e){switch(1===e.status?a.find(".estimate_info_js").css("color","green"):a.find(".estimate_info_js").css("color","red"),removeLoadAnimation("#estimateLoad"),e.status){case 1:void 0!==t?($("#issue_result_ok").find(".info_text").html(e.message),ajax("auth","GetUserProfile",!1,"html").done(function(e){$("#user_profile").append('<img src="/images/noavatar.png"/>'),$(".user_profile_js").html(e),$(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden"),a.find('input[name="name"], input[name="phone"]').closest("div").remove()})):$("#issue_result_ok").find(".info_text").text("Загрузка прошла успешно!"),a.find('[name="comment"], [type="file"]').val(""),a.find(".estimate_info_js").html(""),a.find(".mdl-textfield").removeClass("is-invalid"),openObject("issue_result_ok");break;case 2:a.find('input[name="phone"]').closest(".mdl-textfield").addClass("is-invalid"),a.find(".estimate_info_js").html(e.message);break;case 3:a.find(".estimate_info_js").text(e.message);break;case 4:a.find(".estimate_info_js").html(""),$("#issue_result_err").find(".info_text").html(e.message),openObject("issue_result_err");break;case 5:a.find('input[type="file"]').closest(".mdl-textfield").addClass("is-invalid"),a.find(".estimate_info_js").text(e.message);break;default:console.log(e)}}))}),0===$("header .cart_item a.cart i").data("badge")&&$("#cart .clear_cart").addClass("hidden"),$("#cart_customer_search .search_form_js").on("submit",function(e){e.preventDefault();var a=$("#cart_customer_search .phone").val(),t=a.replace(/\D/g,"");/^(38)?(\d{10})$/.test(t)&&(a=10===t.length?38+t:t),12===a.length?(console.log("телефон проверили все ок"),addLoadAnimation("#cart_customer_search"),ajax("cart","getCustomerInfo",{phone:a},"html").done(function(e){removeLoadAnimation("#cart_customer_search"),$("#cart_customer_search .search_results_block").html(e),void 0===$("#cart_customer_search .customer_main_info input").val()?($("#cart_customer_search .new_name_block").removeClass("hidden"),$("#cart_customer_search .add_customer").addClass("hidden"),$("#cart_customer_search .ceate_new_customer").removeClass("hidden"),$("#cart_customer_search .new_name_block input").each(function(){$(this).val("")})):($("#cart_customer_search .new_name_block").addClass("hidden"),$("#cart_customer_search .add_customer").removeClass("hidden"),$("#cart_customer_search .ceate_new_customer").addClass("hidden"))})):$(this).closest(".search_block").find(".phone").addClass("input_phone_error")}),$("#cart_customer_search .add_customer").on("click",function(){var e=$("#cart_customer_search .customer_main_info input").val();addLoadAnimation("#cart_customer_search"),ajax("cart","bindingCustomerOrder",{id_customer:e}).done(function(e){removeLoadAnimation("#cart_customer_search"),closeObject("cart_customer_search"),openObject("cart")})}),$("#cart_customer_search .ceate_new_customer").on("click",function(){var e=$("#new_user_surname").val(),a=$("#new_user_name").val(),t=$("#new_user_middle_name").val(),s=$("#cart_customer_search .phone").val(),i=!0,n=s.replace(/\D/g,"");/^(38)?(\d{10})$/.test(n)&&(s=10===n.length?38+n:n),$("#cart_customer_search .new_name_block input").each(function(){""===$(this).val()&&($(this).closest("div").addClass("is-invalid"),i=!1)}),!0===i&&(addLoadAnimation("#cart_customer_search"),ajax("cart","createCustomer",{phone:s,first_name:a,last_name:e,middle_name:t}).done(function(e){removeLoadAnimation("#cart_customer_search"),closeObject("cart_customer_search"),openObject("cart")}))}),$("#cart_customer_search .phone").keyup(function(){console.log("нажали"),$(this).removeClass("input_phone_error")}),$(".order").on("click",".number",function(){var e=$(this).closest(".order");e.hasClass("expanded")?$(".order").removeClass("expanded").find(".tabs").slideUp():($(".order").removeClass("expanded").find(".tabs").slideUp(),e.addClass("expanded").find(".tabs").slideDown())}),$(".showall").on("click",function(){$(".order").addClass("expanded").find(".tabs").slideDown()}),$(".hideall").on("click",function(){$(".order").removeClass("expanded").find(".tabs").slideUp()}),$("#percent tr:first").css("color","#000"),$(".toBigPhoto").click(function(e){$("#big_photo img").attr("src",$(this).data("original-photo"))}),moveObjects(),$('input[name="product_limit_checkbox"]').on("change",function(){var e=$(this).data("id-product"),a=$("#product_limit_mopt_"+e);this.checked?limit=1e7:limit=0,a.val(limit),toAssort($(this).data("id-product"),0,$(this).data("koef"),$(this).data("supp"))}),$("body").on("mouseenter","button",function(){var e=parseInt($(this).closest(".quantity").find(".qty_js").val()),a=$(this).closest(".quantity").find(".minQty").val(),t=parseInt($.cookie("sum_range")),s=parseInt($(this).closest(".buy_block").find(".priceOpt3").val()),i=parseInt($(".currentCartSum").html()),n=parseInt($(this).closest(".buy_block").find(".itemProdQty").html());if(!0===$(this).hasClass("btn_remove"))if(e==a){var o=$(this).closest(".buy_block").find(".priceMopt"+t).val();$(".tooltipForBtnRemove_js").removeClass("hidden").html("до "+e+" шт. цена "+o+" грн.")}else 0===t&&i-s<=columnLimits[0]&&$(".tooltipForBtnRemove_js").removeClass("hidden").html("до "+e+" шт. изменит % скидки"),1===t&&i-s<=columnLimits[1]&&$(".tooltipForBtnRemove_js").removeClass("hidden").html("до "+e+" шт. изменит % скидки");else if(e+n==a){var d=$(this).closest(".buy_block").find(".priceOpt"+t).val();$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+a+" шт. цена "+d+" грн.")}else 1===t&&i+s>=columnLimits[0]&&$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+e+" шт. изменит % скидки"),2===t&&i+s>=columnLimits[1]&&$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+e+" шт. изменит % скидки"),3===t&&i+s>=columnLimits[2]&&$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+e+" шт. изменит % скидки")}).on("mouseleave","button",function(){$(".tooltipForBtnAdd_js").addClass("hidden"),$(".tooltipForBtnRemove_js").addClass("hidden")}),$(".to_org_catalog_btn_js").on("click",function(){$.cookie("Segmentation",1,{path:"/"})}),$(".to_magaz_catalog_btn_js").on("click",function(){$.cookie("Segmentation",2,{path:"/"})});var m=!1;$("body").on("click",".err_msg_as_knob_js, .screen_btn_js, .canvasReady_js",function(e){$(this).hasClass("err_msg_as_knob_js")?($(".err_msg_as_js").hasClass("shown")?$(".err_msg_as_js").removeClass("shown").css("top","100%"):$(".err_msg_as_js").addClass("shown").css("top","calc(100% - "+$(".err_msg_as_js").outerHeight()+"px)"),m||(m=!0,e.preventDefault(),$("#err_canvas").attr({width:$(window).outerWidth(),height:$("header").outerHeight()+$("section.main").outerHeight()+$(".phone_err_msg_js").outerHeight()+$("footer").outerHeight()}),$(".screen_btn_js").removeClass("screen_btn_js").addClass("clicked_js").addClass("is-checked"),$(".err_msg_as_js").removeClass("shown").css("top","100%"),$(document).outerWidth()<450&&$(".err_msg_as_form_js .mdl-textfield").css("height","calc(100vh - 345px)"),GetScreenshot())):$(this).hasClass("screen_btn_js")?(e.preventDefault(),m=!0,$("#err_canvas").attr({width:$(window).outerWidth(),height:$("header").outerHeight()+$("section.main").outerHeight()+$(".phone_err_msg_js").outerHeight()+$("footer").outerHeight()}),$(this).removeClass("screen_btn_js").addClass("clicked_js").addClass("is-checked"),$(".err_msg_as_js").removeClass("shown").css("top","100%"),GetScreenshot()):$(this).hasClass("canvasReady_js")&&($(".canvas_toolbar").css("display","none"),GetScreenshot()),$(".err_msg_as_form_js").find("textarea").focus()}),$("body").on("click",".clicked_js",function(e){e.preventDefault(),m=!0,closeObject("big_photo"),$(this).addClass("screen_btn_js").removeClass("is-checked").removeClass("clicked_js"),$("#savedCopyContainer").css("display","none"),$(document).outerWidth()<450&&$(".err_msg_as_form_js .mdl-textfield").css("height","calc(100vh - 145px)"),$(".err_msg_as_js").addClass("shown").css("top","calc(100% - "+$(".err_msg_as_js").outerHeight()+"px)"),$("#savedImageCopy").attr("src",""),$(".err_msg_as_form_js").find("textarea").focus(),$("#err_canvas").attr({width:"20",height:"20"})}),$(".go_to_canvas_toolbar_js").click(function(e){closeObject("big_photo"),$(".err_msg_as_js").removeClass("shown").css("top","100%"),$(".canvas_toolbar").css("display","block"),$("#err_canvas").attr({width:$(window).outerWidth(),height:$("header").outerHeight()+$("section.main").outerHeight()+$(".phone_err_msg_js").outerHeight()+$("footer").outerHeight()})}),$("body").on("click",".img_zoom_js",function(e){$(".err_msg_as_js").removeClass("shown").css("top","100%"),$("#err_canvas").attr({width:"20",height:"20"});var a=$("#savedImageCopy").attr("src");$("#big_photo").css({overflow:"auto","overflow-x":"hidden",padding:"2em"}),$("#big_photo img").attr("src",a).css("width","100%"),openObject("big_photo")}),$(".err_msg_as_send_js").click(function(e){var a={err_msg:$('textarea[name="errcomment"]').val(),img_src:$("#savedImageCopy").attr("src")};ajax("errors","error",a).done(function(e){3!=e.status?($('textarea[name="errcomment"] + label').css("color","rgba(0, 0, 0, .26)"),$('textarea[name="errcomment"]').val("").closest("div").removeClass("is-dirty"),$("#savedCopyContainer").css("display","none"),$(".err_msg_as_js").addClass("shown").css("top","calc(100% - "+$(".err_msg_as_js").outerHeight()+"px)"),$("#savedImageCopy").attr("src",""),$(".err_msg_as_js").removeClass("shown").css("top","100%"),$(".clicked_js").addClass("screen_btn_js").removeClass("clicked_js").removeClass("is-checked"),componentHandler.upgradeDom()):$('textarea[name="errcomment"] + label').css("color","#ff0000");var a={message:e.message};document.querySelector("#snackbar").MaterialSnackbar.showSnackbar(a)})}),$("body").on("click",".problem_area_js",function(){init("yellow","rect")}),$("body").on("click",".confidential_js",function(){init("black","fillrect")}),$("body").on("click",".pencil_for_canvas_js",function(){init("red","pencil")}),$("body").on("click",".eraser_for_canvas_js",function(){init("#fff","eraser")}),$("body").on("click",".canvasClear_js",function(e){clear_canvas()}),$("body").on("click",".close_canvas_toolbar_js",function(e){$(".canvas_toolbar").css("display","none"),$("#err_canvas").attr({width:"20",height:"20"}),clear_canvas()}),$(document).scroll(function(e){$(document).scrollTop()>=$(window).outerHeight()?$(".go_up_js").css("bottom","2em"):$(".go_up_js").css("bottom","-3em")}),$(".go_up_js").click(function(e){$("html, body").animate({scrollTop:0},1e3,"easeInOutCubic")}),$("body").on("click",".mob_search_btn_js",function(e){e.preventDefault(),$("html").addClass("active_bg").find("header").addClass("opened").find("div.search").addClass("is-focused"),componentHandler.upgradeDom()}),$("body").on("click",".header_search_close_js",function(e){e.preventDefault(),$("html").removeClass("active_bg").find("header").removeClass("opened").find("div.search").removeClass("is-focused"),componentHandler.upgradeDom()}),$("body").on("click",".offers_js, .issue_js",function(){var e=$(this),a=$(this).closest(".modal_container").find("form");if(""==a.find("textarea").val()?a.find("textarea").closest(".mdl-textfield").addClass("is-invalid"):a.find("textarea").closest(".mdl-textfield").removeClass("is-invalid"),""==a.find('input[name="user_email"]').val()&&a.find('input[name="user_email"]').closest(".mdl-textfield").addClass("is-invalid"),a.find(".mdl-textfield").hasClass("is-invalid"))""!=a.find('input[name="user_email"]').val()?a.find('input[name="user_email"]').closest(".mdl-textfield").find(".mdl-textfield__error").text("Введите Email правильно"):a.find('input[name="user_email"]').closest(".mdl-textfield").find(".mdl-textfield__error").text("Поле обязательно для заполнения!");else{var t={issue:$(this).hasClass("offers_js")?0:1,id_user:a.find('input[type="hidden"]').val(),email:a.find('input[name="user_email"]').val(),comment:a.find("textarea").val()};ajax("global","SaveGuestComment",t).done(function(t){switch(t.err){case 1:a.find('input[name="user_email"]').closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(t.msg);break;case 2:a.find("textarea").closest(".mdl-textfield").addClass("is-invalid");break;case 3:e.hasClass("offers_js")?closeObject("offers"):closeObject("issue"),$(".issue_result_js .modal_container").html('<div class="issue_ok"><i class="material-icons">check_circle</i></div><p class="info_text">Ваше сообщение было отправлено</p>'),openObject("issue_result");break;case 4:e.hasClass("offers_js")?closeObject("offers"):closeObject("issue"),$(".issue_result_js .modal_container").html('<div class="issue_err"><i class="material-icons">error</i></div><p class="info_text">Что-то пошло не так. Повторите попытку.</p>'),openObject("issue_result");break;default:console.log(t)}}).fail(function(e){console.log("error")})}}),$("body").on("click",".feedback_comment_reply_js",function(e){e.preventDefault(),"false"==$(this).attr("data-isauthorized")?openObject("auth"):($(this).addClass("hidden").closest(".feedback_item_js").find(".comment_reply_cancel_js").removeClass("hidden"),$(this).closest(".feedback_item_js").append('<div class="reply_wrap"><form action="'+$(this).attr("data-action")+'" method="post" onsubmit="onCommentSubmit()"><input type="hidden" name="pid_comment" value="'+$(this).attr("data-idComment")+'"><textarea name="feedback_text" id="feedback_comment_reply" cols="30" required></textarea><div class="user_data hidden"><div class="fild_wrapp"><label for="feedback_author">Ваше имя:</label><input type="text" name="feedback_author" id="feedback_author" required value="Петя"></div><div class="fild_wrapp"><label for="feedback_authors_email">Эл.почта:</label><input type="email" name="feedback_authors_email" id="feedback_authors_email" required value="petya@gmail.com"></div></div><button type="submit" name="sub_com" class="mdl-button mdl-js-button">Ответить</button></form></div>'))}),$("body").on("click",".comment_reply_cancel_js",function(e){e.preventDefault(),$(this).closest(".feedback_item_js").find(".reply_wrap").remove(),$(this).addClass("hidden").closest(".feedback_item_js").find(".feedback_comment_reply_js").removeClass("hidden")}),$("body").on("change",'[name="product_action"]',function(e){var a={},t=$(".product-action-chooser_js");a.id_product=$(this).attr("data-idproduct"),this.checked?a.checked=1:a.checked=0,ajax("products","ProductAction",a).done(function(e){e.list.length>0&&t.hasClass("invisible")?t.addClass("opened").removeClass("invisible"):0==e.list.length&&t.removeClass("opened").addClass("invisible")})}).on("click",".action-chooser__close-js",function(){$(this).closest(".product-action-chooser_js").toggleClass("opened")}).on("click",".action-chooser__clear-js",function(){var e=$(".product-action-chooser_js");ajax("products","ProductActionClear").done(function(a){e.removeClass("opened").addClass("invisible"),location.reload()})}),$("body").on("click",".seasonality_js",function(e){$(this).hasClass("with_demand_graph")||(addLoadAnimation("#seasonality"),$(this).addClass("with_demand_graph"),$(document).outerWidth()>500?$("#seasonality").append('<iframe seamless id="demand_graph" class="demand_graph" src="https://www.google.com/trends/fetchComponent?hl=ru-RU&q='+$("input[name=par_lvl]").val()+"&geo=UA&date=today+24-m&cid=TIMESERIES_GRAPH_0&export=5&w="+($(".tab-content").outerWidth()-(2*parseInt($(".tab-content").css("padding-right"))+8))+'&h=470"></iframe>'):$("#seasonality").append('<iframe seamless id="demand_graph" class="demand_graph" src="https://www.google.com/trends/fetchComponent?hl=ru-RU&q='+$("input[name=par_lvl]").val()+"&geo=UA&date=today+24-m&cid=TIMESERIES_GRAPH_0&export=5&w="+($(".tab-content").outerWidth()-(2*parseInt($(".tab-content").css("padding-right"))+10))+'&h=400"></iframe>'),setTimeout(function(){removeLoadAnimation("#seasonality")},2e3))}),$("body").on("click",".add_del_waiting_list_js",function(e){e.preventDefault();var a=$(this).closest(".wlist_msg_wrap_js");AddInWaitingList(a.data("id-product"),a.data("id-user"),a.data("email"),$(this)),a.find(".add_wrap_js").addClass("hidden"),a.find(".del_wrap_js").removeClass("hidden")}),$("#submit").closest("div").on("click",function(){if(1==$(this).find("#submit").prop("disabled")){var e={message:"Заполните все обязательные поля!"};document.querySelector("#snackbar").MaterialSnackbar.showSnackbar(e)}}),$(".product_label_js").on("click",function(){addLoadAnimation("#gift_products"),ajax("product","GetGiftsList",{},"html").done(function(e){removeLoadAnimation("#gift_products"),$("#gift_products .modal_container").html(e),Position($("#gift_products"))})}),$(".gift_modal").on("click",".gift_product_js",function(){$(this).hasClass("active")?($(".gift_modal .gift_product_js").removeClass("disabled").removeClass("active"),$(".id_gift_input_js").val(null)):($(".gift_modal .gift_product_js").removeClass("active").addClass("disabled"),$(this).removeClass("disabled").addClass("active"),$(".id_gift_input_js").val($(this).find(".id_gift_product_js").val()))}),$(".cart_gift_select_js").on("click",function(){addLoadAnimation(".gift_modal");var e=$(this).closest(".gift_modal").find(".id_gift_input_js").val();ajax("cart","chosenGift",{id_product:e}).done(function(){removeLoadAnimation(".gift_modal"),closeObject("gift_select"),openObject("cart")})}),$(".gift_btn_js").on("click",function(){var e=$(this),a=e.closest(".gift").find(".id_gift_js").val(),t=$(".id_agent_js").val(),s=e.closest(".gift").hasClass("selected")?0:1;addLoadAnimation(e.closest(".gift")),ajax("product","agentGiftToggle",{id_product:a,id_agent:t,add:s}).done(function(a){if(removeLoadAnimation(e.closest(".gift")),!0===a.success)e.closest(".gift").toggleClass("selected");else{var t={message:"Действие прервано. Попробуйте повторить позже."};document.querySelector("#snackbar").MaterialSnackbar.showSnackbar(t)}})}),$("#preview, #caruselCont").on("click","#owl-product_mini_img_js .owl-item",function(e){$(".product_main_img").find("#mainVideoBlock").addClass("hidden"),$(".product_main_img").find("iframe").attr("src","");var a=$(this).find("img").attr("src");if($(window).width()>711){$("#owl-product_mini_img_js").find("img").removeClass("act_img"),$("#owl-product_mini_img_js").find("iframe").removeClass("act_img"),$(this).find("img").addClass("act_img");var t=$(".path_root_js").val(),s=$(".path_product_img_js").val();a=a.indexOf(s.replace(t,""))>-1?a.replace("/thumb/","/original/"):a.replace("_thumb/",""),$(".product_main_img").hide().fadeIn("100").find(".main_img_js").attr("src",a)}else e.preventDefault()}).on("click",".videoBlock",function(e){e.stopPropagation(),$("#owl-product_mini_img_js").find("iframe").removeClass("act_img"),$("#owl-product_mini_img_js").find("img").removeClass("act_img"),$(this).find("iframe").addClass("act_img");var a=$(this).find("iframe").attr("src");$(".product_main_img").find("iframe").attr("src",a),$(".product_main_img").find("#mainVideoBlock").removeClass("hidden")}),$("#demand_graph").load(function(){$(this).contents().find("body").css("overflow","hidden"),$(this).contents().find("head").append('<link type="text/css" rel="Stylesheet" href="https://xt.ua/themes/default/css/page_styles/product.css" />')}),$("body").on("click",".card .favorite i",function(e){e.preventDefault();var a=$(this).closest(".favorite");a.hasClass("added")?(a.removeClass("added"),RemoveFavorite(a.data("id-product"),$(this))):(a.addClass("added"),AddFavorite(a.data("id-product"),$(this)))}),$("body").on("click",".card .waiting_list",function(e){e.preventDefault(e);var a=$(this).closest(".fortrending");$(this).hasClass("arrow")?($(this).removeClass("arrow"),RemoveFromWaitingList(a.data("id-product"),a.data("id-user"),a.data("email"),$(this))):($(this).addClass("arrow"),AddInWaitingList(a.data("id-product"),a.data("id-user"),a.data("email"),$(this)))}),$("body").on("click",".apps_panel .favorite",function(e){e.preventDefault();var a=$(this);a.hasClass("added")?(a.removeClass("added"),RemoveFavorite(a.data("id-product"),$(this),!0)):(a.addClass("added"),AddFavorite(a.data("id-product"),$(this),!0))}),$("body").on("click",".apps_panel .fortrending",function(e){e.preventDefault(e),$(this).find(".waiting_list").hasClass("arrow")?($(this).find(".waiting_list").removeClass("arrow"),RemoveFromWaitingList($(this).data("id-product"),$(this).data("id-user"),$(this).data("email"),$(this))):($(this).find(".waiting_list").addClass("arrow"),AddInWaitingList($(this).data("id-product"),$(this).data("id-user"),$(this).data("email"),$(this)))}),$(".price_help_js").on("click",function(){var e=$(this).closest(".card").data("idproduct"),a=$("#price_details");a.find(".modal_container").html(""),addLoadAnimation(a),ajax("product","priceHelp",{id_product:e},"html").done(function(e){removeLoadAnimation(a),$("#price_details .modal_container").html(e),Position(a)})}),$(".product_main_img").on("click",function(e){$("#big_photo img").css("height",$('#big_photo[data-type="modal"]').outerHeight()+"px")}),$("body").on("click",".show_preview_js",function(){var e=$("#preview"),a=$(this).closest(".card").data("idproduct");Position(e),e.find(".modal_container").html(""),addLoadAnimation(e),ajax("product","GetPreview",{id_product:a},"html").done(function(a){e.find(".modal_container").html(a),componentHandler.upgradeDom(),removeLoadAnimation(e)})}),$("body").on("mouseenter",".search_category .mdl-selectfield__box, .search_category .mdl-selectfield__list-option-box li",function(e){e.preventDefault(),$(".search_category.mdl-selectfield").addClass("is-focused")}),$("body").on("mouseleave",".search_category .mdl-selectfield__box, .search_category .mdl-selectfield__list-option-box li",function(e){e.preventDefault(),$(".search_category.mdl-selectfield").removeClass("is-focused")}),$("body").on("click",".search_category .mdl-selectfield__list-option-box li",function(e){e.preventDefault(),$(".search_category.mdl-selectfield").removeClass("is-focused")}),$("body").on("focusout",".input_validator_js",function(e){userInfoValidator($(this))}),addLoadAnimation(".navbar_js")}),$(document).ready(function(){$("#subCategory_grid").masonry(),ajax("navigation","generateNavigation",!1,"html").done(function(e){if($(".navbar_js").html(e),$(".catalog").hasClass("expanded")){var a=$(".navbar_js").find('[data-lvl="1"] > .link_wrap');$(".navbar_js").height(a.length*a.first().outerHeight())}})});
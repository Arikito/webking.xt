window.onbeforeunload=function(e){},$(window).on("load",function(){$("html, body").trigger("scroll")}),$(function(){GetLocation(),1==$(window.location.hash).length&&"modal"==$(window.location.hash).data("type")&&openObject(window.location.hash.replace("#","")),setTimeout(function(){"agree"!=$.cookie("useCookie")?($(".cookie_msg_js").css("top","calc(100% - "+$(".cookie_msg_js").outerHeight()+"px)"),$("body").on("click",".cookie_msg_js .close",function(e){e.preventDefault(),$(".cookie_msg_js").css("top","100%"),$.cookie("useCookie","agree",{expires:365}),setTimeout(function(){$(".cookie_wrap").remove(),$(".err_msg_as_title").css("opacity","1")},3e3)})):$(".err_msg_as_title").css("opacity","1")},2e3),$(".changeView_js").on("click",function(){var e=$(this).data("view");$(".productsListView i").removeClass("activeView"),$(this).addClass("activeView"),"list"==e?$(".cart_info .price_nav").removeClass("hidden"):$(".cart_info .price_nav").addClass("hidden"),ChangeView(e),resizeAsideScroll("click")}),$(".show_more_js").on("click",function(e){e.preventDefault();var t=$(this).closest(".products_page"),s=current_id_category,a=parseInt(t.find(".paginator li.active").first().text()),i=parseInt(t.find(".paginator li.active").last().text()),o=i+1,n=t.find(".card").get().length,c=30*(a-1),r=$(this).data("cnt");$(".show_more").append('<span class="load_more"></span>');var l={action:"getmoreproducts_desctop",id_category:s,shown_products:n,skipped_products:c};addLoadAnimation(".show_more_js"),ajax("products","getmoreproducts",l,"html").done(function(e){removeLoadAnimation(".show_more_js");var s=($.cookie("product_view"),parseInt(r-30-parseInt(c+n)));t.find(".products").append(e),$("img.lazy").lazyload({effect:"fadeIn"}),t.find(".paginator li.page"+o).length<1?parseInt(r-parseInt(c+n)+30)>30?t.find(".paginator li.next_pages").addClass("active").find("a").attr("href","#"):t.find(".paginator li.last_page").addClass("active").find("a").attr("href","#"):t.find(".paginator li.page"+o).addClass("active").find("a").attr("href","#"),0>s&&$("#show_more_products").hide(),ListenPhotoHover(),$(".load_more").remove(),resizeAsideScroll("show_more")})}),$("body").on("change",".qty_js",function(){var e=$(this).closest(".product_buy").attr("data-idproduct"),t=$(this).val(),s=$(this).closest(".product_section").find(".note textarea").val();SendToAjax(e,t,!1,!1,s)}),$("body").on("click",".buy_btn_js",function(){$(this).closest(".card").find(".note").removeClass("hidden"),$(this).closest(".card").find(".note").hasClass("note_control")&&$(this).closest(".card").find(".note").addClass("activeNoteArea");var e=$(this).closest(".product_buy").attr("data-idproduct"),t=$(this).closest(".product_buy").find(".qty_js").val(),s=$(this).closest(".product_section").find(".note textarea").val();SendToAjax(e,t,!1,!1,s)}),$(".note_field").blur(function(){""!==$(".note_field").val()&&$(this).closest(".card").find(".note").removeClass("activeNoteArea");var e=$(this).data("id"),t=$(this).val();ajax("cart","updateCartQty",{id_product:e,note:t})}),$("body").on("click",".remove_favor_js",function(e){e.preventDefault();var t=$(this).closest(".favorite_js").data("idproduct"),s=$(this);$("#confirmDelItem").data("delIdItem",t).data("list","favor"),s.addClass("clicked_js").closest(".tableRow").addClass("flag_js")}),$("body").on("click",".remove_waitinglist_js",function(e){e.preventDefault();var t=$(this).closest(".waiting_list_js").data("idproduct"),s=$(this);$("#confirmDelItem").data("delIdItem",t).data("list","waiting"),s.addClass("clicked_js").closest(".tableRow").addClass("flag_js")}),$("#confirmDelItem").on("click",".deleteBtn_js",function(){var e=$("#confirmDelItem").data("delIdItem"),t=$(".clicked_js");closeObject("confirmDelItem"),"favor"==$("#confirmDelItem").data("list")?(addLoadAnimation(".flag_js"),ajax("product","del_favorite",{id_product:e}).done(function(e){if(e.fav_count>0){t.closest(".favorite_js").remove(),$(".userChoiceFav").text("("+e.fav_count+")");var e={message:"Товар удален из списка избранных товаров"},s=document.querySelector("#snackbar");s.MaterialSnackbar.showSnackbar(e)}else $("#favorites").html("<h5>У Вас нет избранных товаров</h5>"),$(".userChoiceFav").text("(0)")}).fail(function(e){console.log("Error!")})):"waiting"==$("#confirmDelItem").data("list")&&(addLoadAnimation(".flag_js"),ajax("product","del_from_waitinglist",{id_product:e}).done(function(e){if(e.fav_count>0){t.closest(".waiting_list_js").remove(),$(".userChoiceWait").text("("+e.fav_count+")");var e={message:"Товар удален из листа ожидания"},s=document.querySelector("#snackbar");s.MaterialSnackbar.showSnackbar(e)}else $("#waiting_list").html("<h5>Лист ожидания пуст</h5>"),$(".userChoiceWait").text("(0)")}).fail(function(e){console.log("Error!")})),t.removeClass("clicked_js"),$(".flag_js").removeClass("flag_js")}),$("#confirmDelItem").on("click",".cancelBtn_js",function(){$("#confirmDelItem").removeData("delIdItem"),$(".clicked_js").removeClass("clicked_js"),$(".flag_js").removeClass("flag_js"),closeObject("confirmDelItem")});var e=$("#seoTextBlock").text();e.length>1e3&&$("#seoTextBlock").css("height","175px").parent(".mdl-grid").append('<button id="expand_btn" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Развернуть</button><button id="rollUp_btn" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect hidden">Свернуть</button>'),$("#expand_btn").click(function(){$("#seoTextBlock").css({height:"100%"}),$(this).addClass("hidden"),$("#rollUp_btn").removeClass("hidden"),resizeAsideScroll("show_more")}),$("#rollUp_btn").click(function(){$("#seoTextBlock").css({height:"175px"}),$(this).addClass("hidden"),$("#expand_btn").removeClass("hidden")}),0===$('ul.second_nav.allSections > li.active > ul[data-lvl="2"] > li.active:has(ul)').length||$('ul.second_nav.allSections ul[data-lvl="3"] > li').hasClass("active")?$('.main_nav li[data-nav="filter"]').removeClass("hidden"):$('.main_nav li[data-nav="filter"]').addClass("hidden"),0===$("ul.second_nav.allSections li.active").find("li.active").length&&$('.main_nav li[data-nav="filter"]').addClass("hidden"),$("#segmentNavOrg, #segmentNavStore, #allCategotyCont").find("li.active")&&0===$("ul.second_nav li.active").find("li.active").length&&$('.main_nav li[data-nav="filter"]').addClass("hidden"),$(".main_nav > li").click(function(){$(".main_nav > li").hasClass("active")&&!$("ul.second_nav li").hasClass("active")&&$('.main_nav li[data-nav="filter"]').addClass("hidden")}),$('.second_nav > li[onclick^="segmentOpen"]').click(function(){$('.main_nav li[data-nav="filter"]').addClass("hidden")}),$("body").on("click",'a[href="#"]',function(e){e.preventDefault()});var t=$(window).width(),s=$(window).height(),a=($("section .center").height(),$("header").outerHeight());$("img.lazy").lazyload({effect:"fadeIn"}),$(".sidebar_wrapp").css("max-height",s-a-15),$(".prod_structure span.list").on("click",function(){ChangeView("list")}),$(".prod_structure span.module").on("click",function(){ChangeView("module")});var i=.9;t>712&&(i=.8),$("#cart .order_wrapp").css("max-height",(s-a)*i),$(".mob_s_btn").on("click",function(){$("#search").focus()}),$("#search").on("keyup",function(){""!==$(this).val()?$(".search_btn").hasClass("is-disabled")||$(".search_btn").addClass("is-disabled"):$(".search_btn").hasClass("is-disabled")&&$(".search_btn").removeClass("is-disabled")}),$("#category-lower-right").on("click",function(e){e.preventDefault()}),$(".imit_select").on("click",".mdl-menu__item",function(){var e=$(this).text();$(this).data("value");console.log(e),console.log($(this).closest(".imit_select").find(".select_field").text()),$(this).closest(".imit_select").find(".mdl-menu__item").removeClass("active"),$(this).closest(".imit_select").find(".select_field").text(e),$(this).closest(".mdl-menu__container").removeClass("is-visible"),$(this).addClass("active")}),$(".region.imit_select").on("click",".mdl-menu__item",function(){GetCities($(".region.imit_select").find(".select_field").text()),$(".city.imit_select").find(".select_field").text("Выбрать")}),$(".sort.imit_select .mdl-menu__item").on("click",function(){var e=JSON.parse($.cookie("sorting"));if(void 0!==e.current_controller){e.current_controller.value=$(this).data("value");var t=JSON.stringify(e);$.cookie("sorting",t,{expires:2,path:"/"}),location.reload()}}),$(".menu").on("click",function(){var e=$(this).text();$("header").outerHeight();"menu"==e?$(this).html("close"):$(this).html("menu")}),$(".search_close").on("click",function(){closeObject()});var o=$("header"),n=$("body").hasClass("banner_hide")?!0:!1,c=$(".banner").outerHeight(),r=$(window).height(),l=$(".main").outerHeight(),d=$(".main_nav").outerHeight(!0);window.addEventListener("orientationchange",function(){r=$(window).height()},!1),$.cookie("mainWindow",l,{path:"/"}),$("aside .catalog .second_nav").css("max-height","calc(100vh - "+(d+52)+"px"),$("aside .filters_container").css("max-height","calc(100vh - "+(d+52+43)+"px"),$(window).scroll(function(){if(n===!1)$(this).scrollTop()>c/2-52&&o.hasClass("default")?o.removeClass("default").addClass("filled"):$(this).scrollTop()<=c/2-52&&o.hasClass("filled")&&o.removeClass("filled").addClass("default"),$(this).scrollTop()>c&&(n=!0,$(".banner").height(0),$("body").addClass("banner_hide"),$("html, body").scrollTop(0));else{var e=$(".main").outerHeight(),t=$(this).scrollTop(),s=t+r-e-52+d;t+r>e+52?($("aside .catalog .second_nav").css("max-height","calc(100vh - 52px - "+s+"px"),$("aside .filters_container").css("max-height","calc(100vh - 52px - "+(s+43)+"px")):($("aside .catalog .second_nav").css("max-height","calc(100vh - "+(d+52)+"px"),$("aside .filters_container").css("max-height","calc(100vh - "+(d+52+43)+"px"))}}),$(window).on("load",function(){}),$(window).resize(function(){n===!0&&resizeAsideScroll()}),$(".logo").on("click",function(e){$("body").hasClass("c_main")&&n===!0&&(e.preventDefault(),$(".banner").animate({height:c},300),$("html, body").animate({scrollTop:0},300),$("body").removeClass("banner_hide"),o.removeClass("fixed_panel").addClass("default"),setTimeout(function(){n=!1},305))}),$("aside").on("click",".more_cat",function(){var e=($(this).closest("ul").data("lvl"),$(this).closest("li")),t=e.hasClass("active");$(this).closest("ul").find("li").removeClass("active").find("ul").stop(!0,!0).slideUp(),$(this).find(".material-icons").text("add"),t||(e.addClass("active").find("> ul").stop(!0,!0).slideDown(),$(this).find(".material-icons").text("remove")),$(".second_nav li:not(.active) .more_cat i").text("add")}),$("mdl-menu__container").hover(function(){$(this).addClass("is-visible")},function(){$(this).removeClass("is-visible")}),$(".second_nav li.active > ul").show(),$(".catalog").on("click",".main_nav li",function(){var e=$(this).data("nav");if($("#filterButtons").removeClass("buttonsTop"),"filter"==e){var t=$(this).find("i").text();"filter_list"==t?($(this).find("i").text("highlight_off"),$(this).find("span.title").text("Скрыть"),$(".second_nav, .news ").slideUp(),$(".included_filters").hide(),$(".filters").fadeIn(),$(this).addClass("active")):($(this).find("i").text("filter_list"),$(this).find("span.title").text("Фильтры"),$(".filters").fadeOut(),$(".second_nav, .news").slideDown(),$(".included_filters").show(),$(this).removeClass("active"),$(this).removeClass("hidden"))}else $(".catalog .main_nav li").removeClass("active"),$(this).addClass("active")}),$(".menus").on("click",function(){var e=$(this).closest("li").find("ul");e.hasClass("active")?e.removeClass("active").stop(!0,!0).slideUp():e.addClass("active").stop(!0,!0).slideDown()});var _=getScrollWindow();changeToTop(_),$(window).scroll(function(){_=getScrollWindow(),changeToTop(_)}),$("#toTop").click(function(){$("html, body").animate({scrollTop:0},1e3,"easeInOutCubic")});var m=$(".price"),h=$(".price_nav");if(m.length>0){var v=Math.round(m.offset().left+m.width()/2-h.width()/2);h.offset({left:v})}$(".product_main_img").css("height",$(".product_main_img").outerWidth()),$("#owl-product_mini_img_js").owlCarousel({items:6,itemsCustom:[[320,1],[727,2],[950,3],[1250,4],[1600,5]],navigation:!0,dots:!1,navigationText:['<svg class="arrow_left"><use xlink:href="images/slider_arrows.svg#arrow_left_tidy"></use></svg>','<svg class="arrow_right"><use xlink:href="images/slider_arrows.svg#arrow_right_tidy"></use></svg>']}),$("#owl-popular, #owl-last-viewed, #owl-accompanying").owlCarousel({autoPlay:!1,dots:!1,stopOnHover:!0,slideSpeed:300,paginationSpeed:400,itemsScaleUp:!0,responsive:{320:{items:1},727:{items:3},950:{items:5},1250:{items:6},1600:{items:8}},nav:!0,navText:['<svg class="arrow_left"><use xlink:href="images/slider_arrows.svg#arrow_left_tidy"></use></svg>','<svg class="arrow_right"><use xlink:href="images/slider_arrows.svg#arrow_right_tidy"></use></svg>']}),$(".set_rating").on("change",function(){var e=$(this).val();changestars(e)}),$(".star").hover(function(){var e=$(this).closest("label").find("input").val();changestars(e),$(".feedback_stars").on("mouseleave",function(){e=$(this).find("input:checked").val(),e||(e=0),changestars(e)})}),$(".star").on("click",function(e){var t=$(this).closest("label").find("input");t.is(":checked")&&(e.preventDefault(),t.removeAttr("checked"),changestars(0))}),$("input.mdl-checkbox__input").on("click",function(){}),$("body").on("click",".background_panel",function(){closeObject()}),$('[data-type="modal"]').each(function(e,t){$(this).append('<a href="#" class="close_modal btn_js" data-name="'+$(this).attr("id")+'"><i class="material-icons mdl-cell--hide-phone mdl-cell--hide-tablet">close</i><i class="material-icons mdl-cell--hide-desktop">cancel</i></a>')}),$(".product_main_img").on("click",function(){images=[],$("#owl-product_mini_img_js .owl-item").each(function(){$(this).find("img"),images.push($(this).find("img").attr("class"))});var e=0;$.each(images,function(t,s){console.log("INDEX: "+t+" VALUE: "+s),"act_img"===s&&(e=t)});var t=$("#owl-product_mobile_img_js");t.owlCarousel(),t.trigger("to.owl.carousel",[e,500])}),$("#big_photo img").on("click",function(){closeObject()}),$("body").on("click",".btn_js",function(){var e=$(this).data("name");void 0!==e&&openObject(e)}),$(document).keyup(function(e){27==e.keyCode&&closeObject()}),$(".stat_years canvas").on("click",function(){$(this).closest(".stat_years").find('input[type="range"]').eq(0).val(),$(this).closest(".stat_years").find('input[type="range"]').eq(1).val();$(this).closest(".stat_years").find('input[type="range"]').each(function(e,t){console.log($(t).val())}),openObject("graph")}),$("#icon_graph").on("click",function(){$("div.stat_years").is(":hidden")?$("div.stat_years").slideDown("slow"):$("div.stat_years").slideUp("slow")}),$(".down_graph").on("click",function(){$("div.stat_year").slideUp("slow"),$(".ones").css("opacity","0"),$(".graph_up").removeClass("hidden").animate({opacity:.6},1500).css({transform:"rotate(30deg)"})}),$(".graph_up").on("click",function(){$(this).addClass("hidden"),$("div.stat_year").eq(0).slideDown("slow"),setTimeout(function(){$(".ones").css("opacity","1")},600)}),$(".xgraph_up").on("click",function(){var e=0;$(this).hasClass("two")&&(e=1);var t=!1;ModalGraph(t,e)}),$(".note textarea").on("blur",function(){$(this).css({height:"30px"})}),$(".add_cart_state input:radio").on("click",function(){var e=!1;$(this.checked)&&(e=!0),$(this).prop("checked",e)}),$("#quiz").on("click",".to_step",function(e){function t(e){addLoadAnimation("#quiz"),e.target_step>e.current_step&&e.validate===!0?ajax("quiz","complete_step",e).done(function(t){1==t&&GetQuizAjax({reload:!1,step:e.target_step})}):GetQuizAjax({reload:!1,step:e.target_step})}e.preventDefault();var s=0,a={validate:!1,current_step:$(this).closest('[class*="step_"]').data("step"),target_step:$(this).data("step")},i={summary:$("#quiz .summary_info"),current:$(".step_"+$(this).closest('[class*="step_"]').data("step")),target:$(".step_"+$(this).data("step"))};if(1==a.target_step)2==a.current_step&&t(a);else if(2==a.target_step)if(1==a.current_step){var o=i.current.find('[name="last_name"]').val(),n=i.current.find('[name="first_name"]').val(),c=i.current.find('[name="middle_name"]').val();""===o&&(s++,$("#last_name").addClass("is-invalid")),""===n&&(s++,$("#first_name").addClass("is-invalid")),""===c&&(s++,$("#middle_name").addClass("is-invalid")),0===s&&(a.first_name=n,a.last_name=o,a.middle_name=c,a.validate=!0,t(a))}else 3==a.current_step&&t(a);else 3==a.target_step?2==a.current_step?(a.region=i.current.find("#region").val(),a.city=i.current.find("#city").val(),0===s&&(a.validate=!0,t(a))):4==a.current_step&&t(a):4==a.target_step?3==a.current_step&&(a.region=i.current.find("#region").val(),a.city=i.current.find("#city").val(),a.id_delivery=parseInt(i.current.find("#id_delivery").val()),a.id_delivery_service=parseInt(i.current.find("#id_delivery_service").val()),a.delivery_department=i.current.find("#delivery_department").val(),a.address=i.current.find("#address").val(),0===s&&(a.validate=!0,t(a))):5==a.target_step&&(4==a.current_step,0===s&&(a={delivery_service:delivery_service,delivery_method:delivery_method},ajax("cart","update_info",a,"text").done(function(e){a.validate=!0,t(a)})))}),$(".verification_btn").attr("disabled","disabled"),$("#verification").on("click",'[for="choise_current_pass"]',function(){$(".cur_passwd_container, .confirm_btn_js").removeClass("hidden"),$(".verification_meth, .for_verification_code_js, .confirm_code_js, .send_code_js, .ver_info_js").addClass("hidden"),$(".confirm_pass_js").removeClass("hidden"),$(".error_msg_js").text(""),componentHandler.upgradeDom()}),$("#verification").on("click",'[for="choise_verification_code"]',function(){$(".verification_meth, .send_code_js").removeClass("hidden"),$(".cur_passwd_container, .confirm_pass_js").addClass("hidden"),$(".confirm_code_js").addClass("hidden"),$(".error_msg_js").text(""),componentHandler.upgradeDom()}),$('[name="cur_passwd"]').change(function(e){""==$(this).val()?$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Чтобы продолжить введите Ваш текущий пароль"):$(this).val().length<4&&$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Введите корректный пароль")}),$('[name="verification_code"]').change(function(e){""==$(this).val()?$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Чтобы продолжить введите код подтверждения"):4!=$(this).val().length&&$(this).closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text("Введите корректный код подтверждения")}),$(".send_code_js").click(function(e){$(".for_verification_code_js").removeClass("hidden"),$(".send_code_js").addClass("hidden"),$(".confirm_code_js, .ver_info_js").removeClass("hidden");var t=$('[name="id_user"]').val(),s=$(".phone").val().replace(/[^\d]+/g,"");12==s.length?phone=s:console.log("Неверный формат номера телефона"),data={id_user:t,phone:phone,method:"sms"},console.log(data),ajax("cabinet","AccessCode",data).done(function(e){$(".confirm_btn_js").removeAttr("disabled")})}),$(".confirm_pass_js").click(function(e){var t=$('[name="id_user"]').val(),s=$('[name="new_passwd"]').val(),a=$('[name="verification"]:checked').data("value"),i=$('[name="cur_passwd"]').val();data={id_user:t,new_passwd:s,curr_pass:i,method:a},$(".cur_passwd").hasClass("is-invalid")||(console.log(data),ajax("cabinet","ChangePassword",data).done(function(e){console.log(e.success),e.success?$("#verification").html('<div class="auth_ok tac"><i class="material-icons">check_circle</i></div><p class="info_text" style="min-width: 300px; text-align: center;">Пароль успешно изменен!</p><a href="#" class="close_modal btn_js" data-name="verification"><i class="material-icons mdl-cell--hide-phone mdl-cell--hide-tablet">close</i><i class="material-icons mdl-cell--hide-desktop">cancel</i></a>'):$(".error_msg_js").text(e.msg)}))}),$(".confirm_code_js").click(function(e){var t=$('[name="id_user"]').val(),s=$('[name="new_passwd"]').val(),a=$('[name="verification"]:checked').data("value"),i=$('[name="verification_code"]').val();data={id_user:t,code:i,new_passwd:s,method:a},$(".for_verification_code_js").hasClass("is-invalid")||ajax("cabinet","ChangePassword",data).done(function(e){console.log(e),e.success?$("#verification").html('<div class="auth_ok tac"><i class="material-icons">check_circle</i></div><p class="info_text" style="min-width: 300px; text-align: center;">Пароль успешно изменен!</p><a href="#" class="close_modal btn_js" data-name="verification"><i class="material-icons mdl-cell--hide-phone mdl-cell--hide-tablet">close</i><i class="material-icons mdl-cell--hide-desktop">cancel</i></a>'):$(".error_msg_js").text(e.msg)}).fail(function(e){alert("Ошибка!")})}),$(".phone").mask("+38 (099) ?999-99-99"),$('input[name="options"]').on("change",function(){$("#quiz .company_details").css("display","block")}),$("#quiz .delivery_service").on("click",'input[name="service"]',function(){$('.delivery_service input[name="service"]:checked')&&$('[data-value="2"]')&&(GetDeliveryMethods($(this).val(),$("#city_select .select_field").text()),Position($(this).closest('[data-type="modal"]')))}),$('.delivery_type [data-value="1"]').on("click",function(){$(".delivery_address").css("display","block"),$(".post_office").css("display","none")}),$('.delivery_type [data-value="2"]').on("click",function(){$('.delivery_service input[name="service"]:checked')&&($(".post_office").css("display","block"),$(".delivery_address").css("display","none"),GetDeliveryMethods($('.delivery_service input[name="service"]:checked').val(),$("#city_select .select_field").text()))}),$("#quiz .mdl-button").on("click",function(e){return e.preventDefault(),!1}),$("#access_recovery").on("click",'label[for="chosen_mail"]',function(){$("#access_recovery #recovery_email").closest("div").addClass("hidden"),$("#access_recovery .input_container").html('<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label>Email</label><input class="mdl-textfield__input" name="value" type="email" id="recovery_email"><label class="mdl-textfield__label" for="recovery_email"></label><span class="mdl-textfield__error"></span></div>'),componentHandler.upgradeDom()}),$("#access_recovery").on("click",'label[for="chosen_sms"]',function(){$("#access_recovery #recovery_email").closest("div").addClass("hidden"),$("#access_recovery .input_container").html('<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label>Номер телефона</label><input class="mdl-textfield__input phone" name="value" type="text" id="recovery_phone" pattern="+d{2}s(d{3})sd{3}-d{2}-d{2}"><label class="mdl-textfield__label" for="recovery_phone"></label><span class="mdl-textfield__error"></span></div>'),$(".phone").mask("+38 (099) ?999-99-99"),componentHandler.upgradeDom()}),$("#access_recovery").on("blur",'input[type="email"]',function(){var e=$(this).val();if(""!==e){var t=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i;t.test(e)?$(this).css({color:"green"}):($(this).css({color:"red"}),$(".mdl-textfield__error").text("Введите Email правильно"))}else $(this).css({color:"red"}),$(".mdl-textfield__error").text("Введите Email")}),$("#access_recovery").on("click","#continue",function(e){e.preventDefault();var t,s=$(this).closest('[data-type="modal"]'),a=s.find('[name="recovery_method"]:checked');if("sms"==a.data("value")){var i=$("#access_recovery .phone").val().replace(/[^\d]+/g,"");12==i.length?t=i:console.log("error")}"email"==a.data("value")&&(t=s.find('[name="value"]').val()),data={method:a.data("value"),value:t},addLoadAnimation("#access_recovery"),ajax("auth","accessRecovery",data).done(function(e){removeLoadAnimation("#access_recovery"),e.success?s.find(".password_recovery_container").html(e.content):s.find(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(e.msg),componentHandler.upgradeDom()})}),$("#access_recovery").on("keyup","#passwd",function(e){e.preventDefault();var t=$(this).val(),s=$("#access_recovery #passwdconfirm").val();ValidatePass(t,$(this)),""!==s&&ValidatePassConfirm(t,s)}),$("#access_recovery").on("keyup","#passwdconfirm",function(){var e=$("#access_recovery #passwd").val(),t=$(this).val();ValidatePassConfirm(e,t)}),$("#access_recovery").on("click","#restore",function(e){e.preventDefault();var t=$(this).closest('[data-type="modal"]'),s=t.find('[type="hidden"]').val(),a=t.find('[name="code"]').val();data={id_user:s,code:a},addLoadAnimation("#access_recovery"),ajax("auth","checkСode",data).done(function(e){removeLoadAnimation("#access_recovery"),e.success?t.find(".password_recovery_container").html(e.content):t.find('[name="code"]').closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(e.msg),componentHandler.upgradeDom()})}),$("#access_recovery").on("click","#confirm_btn",function(e){e.preventDefault(),$("#access_recovery .mdl-textfield__error").empty();var t=$(this).closest('[data-type="modal"]'),s=t.find('[type="hidden"]').val(),a=t.find('input[name="new_passwd"]'),i=t.find('input[name="passwdconfirm"]').val();ValidatePass(a.val(),a),a.val().length>=4&&""!==i&&!ValidatePassConfirm(a.val(),i)&&(data={id_user:s,passwd:i},t.find(".mdl-textfield").hasClass("is-invalid")||(addLoadAnimation("#access_recovery"),ajax("auth","accessConfirm",data).done(function(e){removeLoadAnimation("#access_recovery"),console.log(e),e.success?($(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden"),ajax("auth","GetUserProfile",!1,"html").done(function(e){$("#user_profile").append('<img src="/images/noavatar.png"/>'),$(".user_profile_js").html(e),$(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden")}),t.find(".password_recovery_container").html(e.content)):value.closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").text(e.msg),componentHandler.upgradeDom()})))}),$("#regpasswd").keyup(function(e){e.preventDefault();var t=$(this).val(),s=$("#settings #passwdconfirm").val();ValidatePass(t,$(this)),""!==s&&ValidatePassConfirm(t,s)}),$("#passwdconfirm").keyup(function(){var e=$("#settings #regpasswd").val(),t=$(this).val();ValidatePassConfirm(e,t)}),$('#passwd, #regpasswd, [name="passwdconfirm"]').focusout(function(e){e.preventDefault(),$(this).closest(".mdl-textfield").find(".mdl-textfield__error").empty()}),$(".login_btn").on("click",function(e){openObject("auth"),$("#auth #sign_in").show().removeClass("hidden"),$("#auth #sign_up").hide().addClass("hidden"),e.preventDefault()}),$("#auth").on("click",".switch",function(e){e.preventDefault(),$(this).closest(".modal_container").fadeOut().addClass("hidden"),$("#"+$(this).data("name")).hide().removeClass("hidden").fadeIn(),Position($("#auth"))}),$("#auth").on("click",".sign_in",function(e){e.preventDefault(),addLoadAnimation("#sign_in");var t=$(this).closest("form"),s=t.find("input#email").val(),a=t.find("input#passwd").val();t.find(".error").fadeOut(),e.preventDefault();var i=s.replace(/\D/g,""),o=/^(38)?(\d{10})$/;o.test(i)&&(s=10===i.length?38+i:i),ajax("auth","sign_in",{email:s,passwd:a}).done(function(e){$(".userContainer");if(removeLoadAnimation("#sign_in"),1!=e.err){if(n===!0){var s=$(".products_page"),a=current_id_category,i=parseInt(s.find(".paginator li.active").first().text()),o=(parseInt(s.find(".paginator li.active").last().text()),0),c=30*(i-1);$(".show_more").append('<span class="load_more"></span>'),addLoadAnimation(".products");var r={action:"getmoreproducts_desctop",id_category:a,shown_products:o,skipped_products:c};"search"===current_controller||"product"===current_controller?location.reload():UpdateProductsList(s,r)}closeObject("auth"),3==e.member.gid&&($("#header_js .cart_item").addClass("hidden"),removeFromCart()),ajax("auth","GetUserProfile",!1,"html").done(function(e){$("#user_profile").append('<img src="/images/noavatar.png"/>'),$(".user_profile_js").html(e),$(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden"),$("#authorized").removeClass("hidden"),$(".userContainer").removeClass("hidden"),$('button[value="Неавторизован"]').addClass("hidden")}),"main"===current_controller&&location.reload()}else t.find(".error").text(e.msg).fadeIn()})}),$("#sign_up #passwd").keyup(function(){var e=$(this).val(),t=$("#sign_up #passwdconfirm").val();ValidatePass(e,$(this)),""!==t&&ValidatePassConfirm(e,t)}),$("#sign_up #passwdconfirm").keyup(function(){var e=$("#sign_up #passwd").val(),t=$(this).val();ValidatePassConfirm(e,t)}),$("#sign_up .sign_up").click(function(e){e.preventDefault(),addLoadAnimation("#sign_up");var t=$(this).closest("form"),s={};t.find(".mdl-textfield__input").each(function(e,t){s[$(t).attr("name")]=$(t).val()}),ajax("auth","register",s).done(function(e){0===e.err?(ajax("auth","GetUserProfile",!1,"html").done(function(e){$("#user_profile").append('<img src="/images/noavatar.png"/>'),$(".user_profile_js").html(e),$(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden")}),openObject("registerComplete")):$.each(e.errm,function(e,t){$('[name="'+e+'"]').closest(".mdl-textfield").addClass("is-invalid").find(".mdl-textfield__error").html(t)}),removeLoadAnimation("#sign_up")})}),$(".error_js").click(function(e){e.preventDefault();var t=$(this).closest("form"),s={};t.find(".mdl-textfield__input").each(function(e,t){s[$(t).attr("name")]=$(t).val()}),console.log(s),ajax("errors","error",s).done(function(e){console.log(e)})}),$("#estimate").on("click",function(){$(".estimate_info_js").html(""),$("#estimate div").each(function(){$("#estimate div").removeClass("is-invalid")})}),$(".estimate_js").on("click",function(e){e.preventDefault();var t=!0;if(void 0!==$("#estimate_phone").val()){var s=$("#estimate_phone").val(),a=$("#estimate_name").val(),i=s.replace(/\D/g,""),o=/^(38)?(\d{10})$/;o.test(i)&&(s=10===i.length?38+i:i),""===a?($("#estimate_name").closest("div").addClass("is-invalid"),t=!1):12!==s.length?($("#estimate_phone").closest("div").addClass("is-invalid"),t=!1):($("#estimate_phone").val(s),t=!0)}t===!0&&(addLoadAnimation("#estimateLoad"),ajax("product","AddEstimate",new FormData($(this).closest("form")[0]),"json",!0).done(function(e){$(".estimate_info_js").html(e.message),1===e.status?($(".estimate_info_js").css("color","green"),void 0!==$("#estimate_phone").val()&&ajax("auth","GetUserProfile",!1,"html").done(function(e){$("#user_profile").append('<img src="/images/noavatar.png"/>'),$(".user_profile_js").html(e),$(".cabinet_btn").removeClass("hidden"),$(".login_btn").addClass("hidden"),$("#estimate_name, #estimate_phone").closest("div").remove(),$(".estimate_info_js").append("<br>Пользователь создан автоматически при загрузке сметы")})):$(".estimate_info_js").css("color","red"),removeLoadAnimation("#estimateLoad")}))}),0===$("header .cart_item a.cart i").data("badge")&&$("#cart .clear_cart").addClass("hidden"),$(".order").on("click",".number",function(){var e=$(this).closest(".order");e.hasClass("expanded")?$(".order").removeClass("expanded").find(".tabs").slideUp():($(".order").removeClass("expanded").find(".tabs").slideUp(),e.addClass("expanded").find(".tabs").slideDown())}),$(".showall").on("click",function(){$(".order").addClass("expanded").find(".tabs").slideDown()}),$(".hideall").on("click",function(){$(".order").removeClass("expanded").find(".tabs").slideUp()}),$("#percent tr:first").css("color","#000"),$(".toBigPhoto").click(function(e){$("#big_photo img").attr("src",$(this).data("original-photo"))}),moveObjects(),$('input[name="product_limit_checkbox"]').on("change",function(){var e=$(this).data("id-product"),t=$("#product_limit_mopt_"+e);this.checked?limit=1e7:limit=0,t.val(limit),toAssort($(this).data("id-product"),0,$(this).data("koef"),$(this).data("supp"))}),$("body").on("mouseenter","button",function(){var e=parseInt($(this).closest(".quantity").find(".qty_js").val()),t=$(this).closest(".quantity").find(".minQty").val(),s=parseInt($.cookie("sum_range")),a=parseInt($(this).closest(".buy_block").find(".priceOpt3").val()),i=parseInt($(".currentCartSum").html()),o=parseInt($(this).closest(".buy_block").find(".itemProdQty").html());
if($(this).hasClass("btn_remove")===!0)if(e==t){var n=$(this).closest(".buy_block").find(".priceMopt"+s).val();$(".tooltipForBtnRemove_js").removeClass("hidden").html("до "+e+" шт. цена "+n+" грн.")}else 0===s&&1e4>=i-a&&$(".tooltipForBtnRemove_js").removeClass("hidden").html("до "+e+" шт. изменит % скидки"),1===s&&3e3>=i-a&&$(".tooltipForBtnRemove_js").removeClass("hidden").html("до "+e+" шт. изменит % скидки");else if(e+o==t){var c=$(this).closest(".buy_block").find(".priceOpt"+s).val();$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+t+" шт. цена "+c+" грн.")}else 1===s&&i+a>=1e4&&$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+e+" шт. изменит % скидки"),2===s&&i+a>=3e3&&$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+e+" шт. изменит % скидки"),3===s&&i+a>=500&&$(".tooltipForBtnAdd_js").removeClass("hidden").html("больше "+e+" шт. изменит % скидки")}).on("mouseleave","button",function(){$(".tooltipForBtnAdd_js").addClass("hidden"),$(".tooltipForBtnRemove_js").addClass("hidden")}),$(".to_org_catalog_btn_js").on("click",function(){$.cookie("Segmentation",1,{path:"/"})}),$(".to_magaz_catalog_btn_js").on("click",function(){$.cookie("Segmentation",2,{path:"/"})});var f=!1;$(".err_msg_as_knob_js").click(function(e){if($(".err_msg_as").hasClass("shown")?($(".err_msg_as_title i").css("transform","rotate(0deg)"),$(document).outerWidth()<450?$(".err_msg_as").removeClass("shown").css("top","100%"):$(".err_msg_as").removeClass("shown").css("top","calc(100% - 34px)")):($(".err_msg_as_title i").css("transform","rotate(-180deg)"),$(".err_msg_as_form").find("textarea").focus(),$(".err_msg_as_js").css("border-color","#FF865F"),$(".err_msg_as").css("background-color","#fff").addClass("shown").css("top","calc(100% - "+$(".err_msg_as").outerHeight()+"px)")),!f){f=!0,e.preventDefault(),$("#err_canvas").attr({width:$(window).outerWidth(),height:$("header").outerHeight()+$("section.main").outerHeight()+$("footer").outerHeight()}),$(".screen_btn_js").removeClass("screen_btn_js").addClass("clicked_js").addClass("is-checked"),$(".err_msg_as_title i").css("transform","rotate(0deg)"),$(document).outerWidth()<450?($(".err_msg_as").removeClass("shown").css("top","100%"),$(".err_msg_as_form .mdl-textfield").css("height","calc(100vh - 345px)")):$(".err_msg_as").removeClass("shown").css("top","calc(100% - 34px)");var t=$(".err_msg_as_js").detach(),s=$("#snackbar").detach();$(document).outerWidth()<450?($(".waiting_block_for_img_canvas_js").css("top","0"),$("#header_js").css("top","52px")):$(".waiting_block_for_img_canvas_js").css("top","15px"),html2canvas(document.body,{onrendered:function(e){e.id="canvasImg";e.toDataURL("image/jpeg");$(".err_msg_as_wrap").css("display","none"),$(".err_msg_as_wrap").append(t),$(".modals").append(s);var a=document.getElementById("savedImageCopy");a.src=e.toDataURL();var i=document.getElementById("savedCopyContainer");i.style.display="block",$(".err_msg_as_wrap").css("display","block"),$(document).outerWidth()<450?($(".waiting_block_for_img_canvas_js").css("top","-52px"),$("#header_js").css("top","0")):$(".waiting_block_for_img_canvas_js").css("top","-52px"),$(".err_msg_as_title i").css("transform","rotate(180deg)"),$(".err_msg_as").css("background-color","#fff").addClass("shown").css("top","calc(100% - "+$(".err_msg_as").outerHeight()+"px)"),$("#err_canvas").attr({width:"20",height:"20"})}})}}),$("body").on("click",".clicked_js",function(e){e.preventDefault(),f=!0,closeObject("big_photo"),$(this).addClass("screen_btn_js").removeClass("is-checked").removeClass("clicked_js"),$("#savedCopyContainer").css("display","none"),$(document).outerWidth()<450&&$(".err_msg_as_form .mdl-textfield").css("height","calc(100vh - 145px)"),$(".err_msg_as").css("background-color","#fff").addClass("shown").css("top","calc(100% - "+$(".err_msg_as").outerHeight()+"px)"),$("#savedImageCopy").attr("src",""),$("#err_canvas").attr({width:"20",height:"20"})}),$("body").on("click",".screen_btn_js",function(e){e.preventDefault(),f=!0,$("#err_canvas").attr({width:$(window).outerWidth(),height:$("header").outerHeight()+$("section.main").outerHeight()+$("footer").outerHeight()}),$(this).removeClass("screen_btn_js").addClass("clicked_js").addClass("is-checked"),$(".err_msg_as").removeClass("shown").css("top","calc(100% - 34px)");var t=$(".err_msg_as_js").detach(),s=$("#snackbar").detach();$(document).outerWidth()<450?($(".waiting_block_for_img_canvas_js").css("top","0"),$("#header_js").css("top","52px")):$(".waiting_block_for_img_canvas_js").css("top","15px"),html2canvas(document.body,{onrendered:function(e){e.id="canvasImg";e.toDataURL("image/jpeg");$(".err_msg_as_wrap").css("display","none"),$(".err_msg_as_wrap").append(t),$(".modals").append(s);var a=document.getElementById("savedImageCopy");a.src=e.toDataURL();var i=document.getElementById("savedCopyContainer");i.style.display="block",$(".err_msg_as_wrap").css("display","block"),$(document).outerWidth()<450?($(".waiting_block_for_img_canvas_js").css("top","-52px"),$("#header_js").css("top","0"),$(".err_msg_as_form .mdl-textfield").css("height","calc(100vh - 345px)")):$(".waiting_block_for_img_canvas_js").css("top","-52px"),$(".err_msg_as_title i").css("transform","rotate(180deg)"),$(".err_msg_as").css("background-color","#fff").addClass("shown").css("top","calc(100% - "+$(".err_msg_as").outerHeight()+"px)"),$("#err_canvas").attr({width:"20",height:"20"})}})}),$(".go_to_canvas_toolbar_js").click(function(e){closeObject("big_photo"),$(".err_msg_as_title i").css("transform","rotate(0deg)"),$(".err_msg_as").removeClass("shown").css("top","calc(100% - 34px)"),$(".canvas_toolbar").css("display","block"),$("#err_canvas").attr({width:$(window).outerWidth(),height:$("header").outerHeight()+$("section.main").outerHeight()+$("footer").outerHeight()})}),$("body").on("click",".problem_area_js",function(){var e="yellow",t="rect";init(e,t)}),$("body").on("click",".confidential_js",function(){var e="black",t="fillrect";init(e,t)}),$("body").on("click",".pencil_for_canvas_js",function(){var e="red",t="pencil";init(e,t)}),$("body").on("click",".eraser_for_canvas_js",function(){var e="#fff",t="eraser";init(e,t)}),$("body").on("click",".canvasClear_js",function(e){clear_canvas()}),$("body").on("click",".close_canvas_toolbar_js",function(e){$(".canvas_toolbar").css("display","none"),$("#err_canvas").attr({width:"20",height:"20"}),clear_canvas()}),$("body").on("click",".img_zoom_js",function(e){$(".err_msg_as_title i").css("transform","rotate(0deg)"),$(".err_msg_as").removeClass("shown").css("top","calc(100% - 34px)"),$("#err_canvas").attr({width:"20",height:"20"});var t=$("#savedImageCopy").attr("src");$("#big_photo").css({overflow:"auto","overflow-x":"hidden",padding:"2em"}),$("#big_photo img").attr("src",t).css("width","100%"),openObject("big_photo")}),$("body").on("click",".canvasReady_js",function(e){$(".canvas_toolbar").css("display","none");var t=$(".err_msg_as_js").detach(),s=$("#snackbar").detach();$(document).outerWidth()<450?($(".waiting_block_for_img_canvas_js").css("top","0"),$("#header_js").css("top","52px")):$(".waiting_block_for_img_canvas_js").css("top","15px"),html2canvas(document.body,{onrendered:function(e){e.toDataURL("image/jpeg");$(".err_msg_as_wrap").css("display","none"),$(".err_msg_as_wrap").append(t),$(".modals").append(s);var a=document.getElementById("savedImageCopy");a.src=e.toDataURL();var i=document.getElementById("savedCopyContainer");i.style.display="block",$("#savedCopyContainer").css("border-color","#FF865F"),$("#err_canvas").attr({width:"20",height:"20"}),$(".err_msg_as_wrap").css("display","block"),$(document).outerWidth()<450?($(".waiting_block_for_img_canvas_js").css("top","-52px"),$("#header_js").css("top","0")):$(".waiting_block_for_img_canvas_js").css("top","-52px"),$(".err_msg_as_title i").css("transform","rotate(180deg)"),$(".err_msg_as").css("background-color","#fff").addClass("shown").css("top","calc(100% - "+$(".err_msg_as").outerHeight()+"px)"),clear_canvas()}})}),$(".err_msg_as_send_js").click(function(e){var t=$('textarea[name="errcomment"]').val(),s=$("#savedImageCopy").attr("src"),a={err_msg:t,img_src:s};ajax("errors","error",a).done(function(e){3!=e.status?($('textarea[name="errcomment"] + label').css("color","rgba(0, 0, 0, .26)"),$('textarea[name="errcomment"]').val("").closest("div").removeClass("is-dirty"),$("#savedCopyContainer").css("display","none"),$(".err_msg_as").css("background-color","#fff").addClass("shown").css("top","calc(100% - "+$(".err_msg_as").outerHeight()+"px)"),$("#savedImageCopy").attr("src",""),$(".err_msg_as").removeClass("shown").css("top","calc(100% - 34px)"),$(".clicked_js").addClass("screen_btn_js").removeClass("clicked_js").removeClass("is-checked"),componentHandler.upgradeDom()):$('textarea[name="errcomment"] + label').css("color","#ff0000");var t={message:e.message},s=document.querySelector("#snackbar");s.MaterialSnackbar.showSnackbar(t)}).fail(function(e){console.log("Сообщение об ошибке не отправлено")})}),$(document).scroll(function(e){$(document).scrollTop()>=$(window).outerHeight()?$(".go_up_js").css("bottom","2em"):$(".go_up_js").css("bottom","-3em")}),$(".go_up_js").click(function(e){$("html, body").animate({scrollTop:0},1e3,"easeInOutCubic")})});